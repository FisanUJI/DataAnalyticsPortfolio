"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8247],{208247:(e,t,r)=>{r.d(t,{c:()=>L});var a=r(406029),s=r(659830),l=r(126966),n=r(402654),i=r(29264),o=r(455729),u=r(990493);class c extends o.PureComponent{constructor(e){super(e),this.updateStoryOffsetContext=(e,t)=>{t?this.setState({...e,updateStoryOffsetContext:this.updateStoryOffsetContext}):this.setState(t=>({...t,...e,updateStoryOffsetContext:this.updateStoryOffsetContext}))},this.state={updateStoryOffsetContext:this.updateStoryOffsetContext,storyOffset:{navBarHeight:"0rem"}}}render(){return(0,a.jsx)(u.i.Provider,{value:this.state,children:this.props.children})}}var d=r(647682),h=r(89826),f=r(425233),p=r(153072),m=r(647345),C=r(504368),y=r(9653),S=r(54302),g=r(960642),x=r(564872),b=r(150547);let w=e=>{let{itemDetails:t}=e,r=(0,x.T9)(),[a,s]=(0,o.useState)(),[l,n]=(0,o.useState)(),[i,u]=(0,o.useState)(),[c,w]=(0,o.useState)(!1),[L,T]=(0,o.useState)(!1),[v,O]=(0,o.useState)(!0),{authManager:P}=(0,h.Py)(),j=(0,b.A)(),k=(0,p.UK)(),E=e=>e?.find(e=>e.startsWith(f.cC.hasTranslation)),I=(0,o.useCallback)(e=>{u(i?.filter(t=>e.includes(t.id)))},[i]),A=(0,o.useCallback)(()=>{I(l?.map(e=>e.id)||[])},[I,l]),K=(0,o.useCallback)(e=>{s(a?.filter(t=>!e.includes(t.id)))},[a]),$=(0,o.useCallback)(e=>e.map(e=>{let a=e.culture??"en-us",s=E(e.typeKeywords),l=t?.properties?.allowedTranslations?.includes(e.id),n=r?.find(e=>{let t=a;return"en-ca"===t&&(t="en"),t.includes(e.culture.toLowerCase())}),i=`${n?.localizedName} - ${n?.language}`,o=s===f.cC.hasTranslation,u=o?`${i} (${j("viewer.languageSettings.languageIsSource")})`:i;return{id:e.id,culture:a,label:u,title:e.title,isSourceItem:o,itemType:(0,m.EN)(e),hasDetachedFromSource:!s&&l}}),[j,t?.properties?.allowedTranslations,r]),N=(0,o.useCallback)(async(e,t)=>{if(t&&i)return i;if(!e||0===e.length)return[];try{let t=await (0,C.Lc)({filter:y.b.fetchAllPublicySharedPublishedStoriesByIds(e),authentication:P}),r=$(t.results);return u(e=>{if(e){let t=r.filter(t=>!e.some(e=>e.id===t.id));return[...e,...t]}return r}),r}catch(e){return T(!0),O(!1),[]}},[i,P,$]),_=(0,o.useCallback)(async()=>{if(T(!1),!t?.id||!t?.typeKeywords||(0,S.m5)(t))return void O(!0);if(!a){if(O(!0),!r)return;let e=[],a=E(t?.typeKeywords),l=a===f.cC.hasTranslation||!a;w(l);try{let r;if(l)e=[...t.properties?.allowedTranslations??[]];else{let t=a?.split(":")[1]??"";e=[...(await (0,d.Gq)(t,{authentication:P,portal:(0,g.mZ)(k.PORTAL_HOST)})).properties.allowedTranslations,t]}e.length>0&&(r=await (0,C.Lc)({filter:y.b.fetchAllPublicySharedPublishedStoriesByIds(e),portal:(0,g.mZ)(k.PORTAL_HOST)}));let i=[...r?.results??[]];l&&(i=[...i,t]);let o=$(i);return o.length>0&&(s(o),n(o)),T(!1),O(!1),o}catch(e){return T(!0),O(!1),e.response}}},[t,a,r,$,P,k.PORTAL_HOST]);return(0,o.useEffect)(()=>{let e;try{"requestIdleCallback"in window?e=requestIdleCallback(()=>{_()}):_()}catch(e){T(!0),O(!1),console.error("Error fetching supported languages:",e)}return()=>{e&&cancelIdleCallback(e)}},[_]),{supportedLanguages:a,refetchLanguages:_,resetToPublished:A,fetchAddedTranslations:N,resetAddedTranslationLanguagesToDraft:I,removeSupportedTranslations:K,addedTranslationsLanguages:i,isLoading:v,isError:L,isSourceItem:c}};function L(e){let{areLabFeaturesEnabled:t=!1,children:r,storyItem:o}=e,u=w({itemDetails:o?.itemDetails});return(0,a.jsx)(s.TG,{areLabFeaturesEnabled:t,children:(0,a.jsx)(l.AK,{storyItem:o,children:(0,a.jsx)(c,{children:(0,a.jsx)(n.ZL,{multiLang:u,children:(0,a.jsx)(i.Y,{children:r})})})})})}},402654:(e,t,r)=>{r.d(t,{X3:()=>n,ZK:()=>o,ZL:()=>i});var a=r(406029),s=r(455729);let l=(0,s.createContext)({}),n=()=>(0,s.useContext)(l),i=e=>{let{children:t,...r}=e;return(0,a.jsx)(l.Provider,{value:r.multiLang,children:t})},o=e=>t=>(0,a.jsx)(l.Consumer,{children:r=>(0,a.jsx)(e,{...t,multiLang:r})})},564872:(e,t,r)=>{r.d(t,{$N:()=>d,T9:()=>m,dm:()=>C,fd:()=>p,wq:()=>h,zM:()=>f});var a=r(406029),s=r(455729),l=r(777011),n=r(89826),i=r(960642),o=r(153072),u=r(159004),c=r(642245);let d=e=>e.nodes[e.root]?.config?.storyLocale,h=async e=>{{let{setLocale:t}=await Promise.all([r.e(84398),r.e(4575),r.e(98546)]).then(r.bind(r,698546));t(e??window.document.documentElement.lang??"en")}},f=async(e,t)=>{let r=t||window?.document?.documentElement?.lang||"en-us",a=`${(0,i.mZ)(e)}/portals/regions?f=json&culture=${r}`;return await (0,l.Em)(a,{httpMethod:"GET"})},p=e=>e.map((e,t)=>({id:t,labelId:"",label:e.localizedName,searchModifier:"",iSearchOptions:{categories:`/Region/${e.region}`}})),m=e=>{let{authManager:t}=(0,n.Py)(),r=(0,o.UK)(),{allSupportedLanguages:a}=(0,c.Ut)(),[l,d]=(0,s.useState)(),h=(0,i.mZ)(r.PORTAL_HOST,t),f=(0,s.useMemo)(()=>new Set(e?.supportedLocales?.map(e=>(0,u.KN)(e,a))??[]),[e?.supportedLocales,a]);return(0,s.useEffect)(()=>{(async()=>{if(h)try{let e=await (0,u.Ar)(h);d(e)}catch(e){console.error(e)}})()},[h]),(0,s.useMemo)(()=>l?f.size?l.filter(e=>{let t=(0,u.KN)(e.culture,a);return f.has(t)}):l:void 0,[l,f,a])},C=(e,t)=>r=>{let s=m(t);return(0,a.jsx)(e,{portalLanguages:s,...r})}},642245:(e,t,r)=>{r.d(t,{Ut:()=>l}),r(406029);var a=r(455729);let s=(0,a.createContext)({translateContentIntoLocale:()=>void 0,submitTranslationFeedback:()=>void 0,allSupportedLanguages:[]}),l=()=>(0,a.useContext)(s)},659830:(e,t,r)=>{r.d(t,{$m:()=>o,Pg:()=>n,TG:()=>i});var a=r(406029),s=r(455729);let l=(0,s.createContext)({areLabFeaturesEnabled:!1}),n=()=>(0,s.useContext)(l).areLabFeaturesEnabled,i=e=>{let{children:t,areLabFeaturesEnabled:r}=e;return(0,a.jsx)(l.Provider,{value:{areLabFeaturesEnabled:r},children:t})},o=e=>t=>(0,a.jsx)(l.Consumer,{children:r=>(0,a.jsx)(e,{...t,...r})})},990493:(e,t,r)=>{r.d(t,{S:()=>l,i:()=>s});var a=r(455729);let s=(0,a.createContext)({updateStoryOffsetContext:()=>{},storyOffset:{navBarHeight:"0rem"}}),l=()=>(0,a.useContext)(s)}}]);