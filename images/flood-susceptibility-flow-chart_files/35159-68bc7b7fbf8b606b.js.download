"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4377,17709,35159],{13453:(e,t,s)=>{s.d(t,{KM:()=>b,Rs:()=>v,bj:()=>x,pp:()=>y});var i=s(455729),o=s(947),a=s(564872),r=s(331366),n=s(269116),l=s(213218),p=s(151130),c=s(623683),d=s(470081),h=s(447201),m=s(717483);let y=e=>{(0,i.useEffect)(()=>{(0,a.wq)(e)},[e])},g=e=>{let t=(0,i.useRef)();return{initialThemeItemInfo:e??t.current,setInitialThemeItemInfo:(0,i.useCallback)(e=>{t.current=e},[])}},u=e=>{let{itemType:t,isOrgItem:s,isEmbedded:i,headerQuery:o}=e;return!s||!!i&&"briefing"===t&&"false"!==o||(!i||"true"===o||""===o)&&"false"!==o},x=e=>{let{itemType:t,isOrgItem:s,isEmbedded:o,headerQuery:a}=e,r=(0,c.A)(!0),n=(0,i.useMemo)(()=>u({itemType:t,isOrgItem:s,isEmbedded:o,headerQuery:a}),[s,o,t,a]);return!!r&&n},f=e=>{let{itemType:t,version:s,viewerMode:o,id:a,itemDetails:n,versionedItemData:l,authManager:p,storyMapUserPrivileges:c,config:d}=e,h=new r.A({type:t,authManager:p,version:s,getStoryMapUserPrivileges:()=>c,viewerMode:o,config:d});return a&&(h.itemId=a),n&&(h.itemDetails=n),l&&(h.itemData=l),(0,i.useRef)(h).current},A=e=>{let{itemType:t,version:s,viewerMode:o,id:a,itemDetails:r,versionedItemData:l,authManager:p,storyMapUserPrivileges:c,config:d}=e,h=new n.Ay({type:t,authManager:p,version:s,getStoryMapUserPrivileges:()=>c,viewerMode:o,config:d});return a&&(h.itemId=a),r&&(h.itemDetails=r),l&&(h.itemDraftData=l),(0,i.useRef)(h).current},w=(0,d.N)(),b=(e,t)=>{let{id:s,itemDetails:o,publishedData:a,setLocaleFromPage:r,query:n,config:p,signInUrl:c,authManager:d,storyMapUserPrivileges:y}=t,[u,x]=(0,i.useState)(!w),A=f({itemType:e,version:"published",viewerMode:"view",authManager:d,storyMapUserPrivileges:y,config:p,...u?{id:s,itemDetails:o,versionedItemData:a}:{}}),{initialThemeItemInfo:b,setInitialThemeItemInfo:v}=g(t.initialThemeItemInfo);return(0,i.useEffect)(()=>{let t=!1;return(async()=>{try{if(!u){let s=await (0,h.V)({id:n?.id,config:p,signInUrl:c,authManager:d,itemType:e,shouldRedirect:!0,convertRoute:m.N});if(t||!s.success)return;let{id:i,itemDetails:o,publishedData:a,pageLocale:l,initialThemeItemInfo:y}=s;A.itemId=i,A.itemDetails=o,A.itemData=a,v(y),await r({pageLocale:l}),x(!0)}}catch(e){x(()=>{if(e instanceof l.D)throw new l.D(e);throw Error(e)})}})(),()=>{t=!0}},[A,v,u,e,r,n,p,c,d]),{isReady:u,storyItem:A,initialThemeItemInfo:b}},v=(e,t)=>{let{id:s,itemDetails:a,draftData:r,locale:n,setLocaleFromPage:c,query:d,config:y,signInUrl:u,authManager:x,storyMapUserPrivileges:f}=t,{formatMessage:b}=(0,o.A)(),v=d?.id===p.p8||s===p.p8,[I,S]=(0,i.useState)(!(w||v)),T=A({itemType:e,version:"draft",viewerMode:"preview",authManager:x,storyMapUserPrivileges:f,config:y,...I?{id:s,itemDetails:a,versionedItemData:r}:{}}),{initialThemeItemInfo:k,setInitialThemeItemInfo:D}=g(t.initialThemeItemInfo);return(0,i.useEffect)(()=>{let t=!1;return(async()=>{try{if(!I){v&&await c({pageLocale:n});let s=await (0,h.O8)({id:d?.id,config:y,signInUrl:u,authManager:x,formatMessage:b,itemType:e,shouldRedirect:!0,convertRoute:m.N});if(t||!s.success)return;let{id:i,itemDetails:o,draftData:a,pageLocale:r,initialThemeItemInfo:l}=s;T.itemId=i,T.itemDetails=o,T.itemDraftData=a,D(l),v||await c({pageLocale:r}),S(!0)}}catch(e){S(()=>{if(e instanceof l.D)throw new l.D(e);throw Error(e)})}})(),()=>{t=!0}},[T,D,I,e,n,c,d,y,u,x,v,b]),{isReady:I,storyItem:T,initialThemeItemInfo:k,mode:d?.mode||"preview"}}},20427:(e,t,s)=>{s.d(t,{R:()=>i});let i="M6 1.773l15 10.23L6 22.226z"},47717:(e,t,s)=>{let i;s.d(t,{A:()=>e9});var o=s(406029),a=s(94588),r=s.n(a),n=s(455729),l=s(390248),p=s(639151),c=s(332988),d=s.n(c),h=s(795669),m=s.n(h),y=s(464090),g=s(716450),u=s(459358),x=s(366317),f=s(89826),A=s(348239),w=s(54831),b=s(840543),v=s(230658),I=s(254033),S=s(255281),T=s(724490),k=s(387189),D=s(153072),j=s(351453),C=s(999276),$=s(651619),L=s(270350);let z=["action-button","briefing","briefing-slide","briefing-slide-content-pane","briefing-ui","collection","collection-ui","collection-cover","collection-nav","collection-item","collection-map","attribution","frame","frame-timeline","frame-custom","frame-journey","frame-narrative-panel","frame-slide","immersive-narrative-panel","immersive-slide","journey-map","journey-place","navigation","outline","story","timeline-event","timeline-spacer","tour-map","tour-place"];var _=s(300982),M=s(856097),E=s(243633),R=s(874400),P=s(150547);let B=e=>{let t=(0,P.A)(),{theme:s}=(0,g.df)(),i=(0,w.Ye)();return(0,o.jsxs)("div",{className:r().dynamic([["f0aecb0573133c3b",[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge]]])+" container",children:[(0,o.jsx)("h3",{className:r().dynamic([["f0aecb0573133c3b",[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge]]])+" title",children:t("component.builderHeader.storySettings.analytics.message.title")}),(0,o.jsx)("div",{dangerouslySetInnerHTML:{__html:e.message},className:r().dynamic([["f0aecb0573133c3b",[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge]]])+" message-container"}),(0,o.jsx)(E.A,{primaryButtonTitle:t("component.builderHeader.storySettings.analytics.message.button.allow"),onPrimaryButtonClick:e.onAllowClicked,orientation:i.isViewportMinWidth("medium")?"horizontal":"vertical",startContent:(0,o.jsx)("h4",{className:r().dynamic([["f0aecb0573133c3b",[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge]]])+" footer-label",children:t("component.builderHeader.storySettings.analytics.message.allowTracking")})}),(0,o.jsx)("button",{"aria-label":t("common.close"),onClick:e.onDismissClicked,className:r().dynamic([["f0aecb0573133c3b",[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge]]])+" close-button",children:(0,o.jsx)(R.A,{path:_.s,size:16,fill:s.colors.labelPrimary})}),(0,o.jsx)(r(),{id:"f0aecb0573133c3b",dynamic:[u.Ay.spacing.sm,M.Ay.shadow.sm(),M.Ay.overflowWrap(),u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.spacing.xxs,u.Ay.color.white,u.Ay.spacing.xs,u.Ay.spacing.xxs,M.Ay.typography.subtitleSmall(),u.Ay.color.darkGreen,u.Ay.spacing.xxxs,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.typography.bodySmall(),u.Ay.color.cadet,u.Ay.spacing.xs,u.Ay.spacing.xs,u.Ay.spacing.xxs,s.colors.labelLink,M.Ay.typography.bodyLarge(),u.Ay.spacing.xxxxs,u.Ay.spacing.xxxxs,u.Ay.spacing.xxxs,x.Gs.RTL,u.Ay.spacing.xxxxs,u.Ay.responsiveBreakpoints.large,u.Ay.responsiveBreakpoints.extraLarge],children:`.container.__jsx-style-dynamic-selector{--space-from-bottom:${u.Ay.spacing.sm};${M.Ay.shadow.sm()}          ${M.Ay.overflowWrap()}          position: fixed;z-index:9999;bottom:var(--space-from-bottom);left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);width:100%;max-width:-webkit-calc(100% - ${u.Ay.spacing.xxs} - ${u.Ay.spacing.xxs});max-width:-moz-calc(100% - ${u.Ay.spacing.xxs} - ${u.Ay.spacing.xxs});max-width:calc(100% - ${u.Ay.spacing.xxs} - ${u.Ay.spacing.xxs});max-height:-webkit-calc(100vh - var(--space-from-bottom) - ${u.Ay.spacing.xxs});max-height:-moz-calc(100vh - var(--space-from-bottom) - ${u.Ay.spacing.xxs});max-height:calc(100vh - var(--space-from-bottom) - ${u.Ay.spacing.xxs});display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background-color:${u.Ay.color.white};padding:${u.Ay.spacing.xs} 0 ${u.Ay.spacing.xxs}}.title.__jsx-style-dynamic-selector{${M.Ay.typography.subtitleSmall()}          color: ${u.Ay.color.darkGreen};margin-bottom:${u.Ay.spacing.xxxs};-webkit-padding-start:${u.Ay.spacing.xs};-moz-padding-start:${u.Ay.spacing.xs};padding-inline-start:${u.Ay.spacing.xs};-webkit-padding-end:${u.Ay.spacing.md};-moz-padding-end:${u.Ay.spacing.md};padding-inline-end:${u.Ay.spacing.md}}.message-container.__jsx-style-dynamic-selector{${M.Ay.typography.bodySmall()}          overflow-y: auto;color:${u.Ay.color.cadet};-webkit-padding-start:${u.Ay.spacing.xs};-moz-padding-start:${u.Ay.spacing.xs};padding-inline-start:${u.Ay.spacing.xs};-webkit-padding-end:${u.Ay.spacing.xs};-moz-padding-end:${u.Ay.spacing.xs};padding-inline-end:${u.Ay.spacing.xs};padding-bottom:${u.Ay.spacing.xxs}}.message-container.__jsx-style-dynamic-selector a,.message-container.__jsx-style-dynamic-selector a:visited{color:${s.colors.labelLink}}.footer-label.__jsx-style-dynamic-selector{${M.Ay.typography.bodyLarge()}}.close-button.__jsx-style-dynamic-selector{position:absolute;top:${u.Ay.spacing.xxxxs};right:${u.Ay.spacing.xxxxs};padding:${u.Ay.spacing.xxxs};line-height:0}${x.Gs.RTL} .close-button.__jsx-style-dynamic-selector{right:unset;left:${u.Ay.spacing.xxxxs}}@media(min-width:${u.Ay.responsiveBreakpoints.large}){.container.__jsx-style-dynamic-selector{width:75%;max-width:${u.Ay.responsiveBreakpoints.extraLarge}}}`})]})};var H=s(125575),N=s(126966),O=s(616053),U=s(918300),V=s(354583),W=s(239663),F=s(909005),G=s(502436),q=s(668718),K=s(402654),Z=s(101570),Y=s(99979),J=s(241523),Q=s(664885),X=s(935686),ee=s(260364),et=s(207664),es=s(934829),ei=s(367875),eo=s(99760),ea=s(20427),er=s(894368);let en={"1/2x":"M15 23H8.1v-.5c0-2.157 1.762-3.105 3.316-3.942 1.392-.748 2.593-1.394 2.593-2.721 0-1.046-1.184-1.837-2.47-1.855a2.38 2.38 0 0 0-2.001.72A2.118 2.118 0 0 0 8.973 16h-.97a2.954 2.954 0 0 1 .823-2 3.437 3.437 0 0 1 2.727-1c1.828 0 3.438 1.245 3.438 2.837 0 1.924-1.639 2.815-3.1 3.602-1.273.685-2.482 1.335-2.74 2.561H15zM11 3.422l-.916-.4-8.077 18.57.916.4zM4 2.207L1.011 3.634l.43.903L3 3.793v8.167h1zM22.689 9L20.5 11.696 18.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L22.689 16h1.306l-2.842-3.5L23.995 9z","1x":"M9 21H8V4.743L4.804 6l-.377-.882L9 3.257zm9.689-12L16.5 11.696 14.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L18.689 16h1.306l-2.842-3.5L19.995 9z","2x":"M13 20H2.004v-.5c0-3.497 2.885-5.076 5.43-6.469 2.352-1.287 4.575-2.504 4.575-5.007a4.172 4.172 0 0 0-4.173-4.038A4.693 4.693 0 0 0 4.31 5.304a5.604 5.604 0 0 0-1.315 3.685l-.989.005A6.475 6.475 0 0 1 3.59 4.611a5.63 5.63 0 0 1 4.246-1.598A5.155 5.155 0 0 1 13 8.024c0 3.096-2.581 4.514-5.086 5.884-2.376 1.3-4.627 2.532-4.886 5.092H13zm8.689-11L19.5 11.696 17.311 9h-1.306l2.842 3.5-2.842 3.5h1.306l2.189-2.696L21.689 16h1.306l-2.842-3.5L22.995 9z"};class el extends n.PureComponent{constructor(e){super(e),this.setHoverState=()=>{this.state.isHovering||this.setState({isShowing:!0,isHovering:!0})},this.removeHoverState=()=>{this.state.isHovering&&this.setState({isHovering:!1})},this.state={isShowing:this.props.isShowing,isHovering:!1}}componentDidUpdate(){this.props.isShowing===this.state.isShowing||this.state.isHovering||this.setState({isShowing:this.props.isShowing})}render(){let e=this.state.isShowing?"visible":"hidden",t=this.props.intl.formatMessage({id:"component.autoplay.returnToTop"}),s=this.props.intl.formatMessage({id:"common.autoplay.play"}),i=this.props.intl.formatMessage({id:"common.autoplay.pause"}),a=this.props.intl.formatMessage({id:"component.autoplay.toggleSpeed"});return(0,o.jsxs)("div",{onMouseEnter:this.setHoverState,onMouseLeave:this.removeHoverState,className:r().dynamic([["b5b1df6715b03faa",[this.props.appOffset.bottom,u.Ay.spacing.xxl,u.Ay.spacing.xxxxs,M.Ay.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,+!!this.state.isShowing,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.gapped({direction:"horizontal",gap:u.Ay.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay",children:[(0,o.jsxs)("div",{className:r().dynamic([["b5b1df6715b03faa",[this.props.appOffset.bottom,u.Ay.spacing.xxl,u.Ay.spacing.xxxxs,M.Ay.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,+!!this.state.isShowing,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.gapped({direction:"horizontal",gap:u.Ay.spacing.xs,alignItems:"center",justifyContent:"center"})]]])+" autoplay-controls-wrapper",children:[(0,o.jsx)(er.Ay,{type:"single-icon",onClick:this.props.onResetClick,visuallyHiddenLabel:t,children:(0,o.jsx)(R.A,{path:eo.M})}),this.props.isPlaying?(0,o.jsx)(er.Ay,{type:"single-icon",onClick:this.props.onPlayToggle,visuallyHiddenLabel:i,children:(0,o.jsx)(R.A,{path:"M4 2h6v20H4zm10 20h6V2h-6z"})}):(0,o.jsx)(er.Ay,{type:"single-icon",onClick:this.props.onPlayToggle,visuallyHiddenLabel:s,children:(0,o.jsx)(R.A,{path:ea.R})}),(0,o.jsx)(er.Ay,{type:"single-icon",onClick:this.props.onSpeedToggle,visuallyHiddenLabel:a,children:(0,o.jsx)(R.A,{path:en[this.props.speed]})})]}),(0,o.jsx)(r(),{id:"b5b1df6715b03faa",dynamic:[this.props.appOffset.bottom,u.Ay.spacing.xxl,u.Ay.spacing.xxxxs,M.Ay.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85),e,+!!this.state.isShowing,u.Ay.spacing.xs,u.Ay.spacing.md,M.Ay.gapped({direction:"horizontal",gap:u.Ay.spacing.xs,alignItems:"center",justifyContent:"center"})],children:`.autoplay.__jsx-style-dynamic-selector{position:fixed;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);bottom:-webkit-calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.xxl});bottom:-moz-calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.xxl});bottom:calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.xxl});-webkit-border-radius:${u.Ay.spacing.xxxxs};-moz-border-radius:${u.Ay.spacing.xxxxs};border-radius:${u.Ay.spacing.xxxxs};background-color:${M.Ay.hexA(this.props.websiteDesign.theme.colors.backgroundPrimary,.85)};z-index:10;visibility:${e};opacity:${+!!this.state.isShowing};-webkit-transition:opacity.5s linear,visibility.5s linear;-moz-transition:opacity.5s linear,visibility.5s linear;-o-transition:opacity.5s linear,visibility.5s linear;transition:opacity.5s linear,visibility.5s linear;padding:${u.Ay.spacing.xs} ${u.Ay.spacing.md}}.autoplay-controls-wrapper.__jsx-style-dynamic-selector{${M.Ay.gapped({direction:"horizontal",gap:u.Ay.spacing.xs,alignItems:"center",justifyContent:"center"})}}`})]})}}let ep=(0,g.NV)((0,V.Cm)((0,p.Ay)(el)));var ec=s(430745);class ed extends n.PureComponent{constructor(e){var t;super(e),t=this,this.lastMouseMoveTime=0,this.lastScrollTime=0,this.isReaderScrolling=!1,this.autoplayNode=(0,n.createRef)(),this.autoplayEnabledSetup=async()=>{this.shouldToggleAutoPlayControls()&&this.toggleAutoplay(),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("wheel",this.handleWindowScroll),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("touchstart",this.handleMouseDown),this.interactionTimer=window.setInterval(this.interactionDelayCheck,500),this.props.collectionBlock&&(await this.props.collectionBlock?.do("switchToCurrentActiveItem"),this.autoplayCollectionItem()),this.props.storyItem.type===v.z.Briefing&&this.autoplayBriefingSlide()},this.autoplayDisabledCleanup=()=>{clearInterval(this.interactionTimer),clearInterval(this.scrollTimer),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("wheel",this.handleWindowScroll),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("touchstart",this.handleMouseDown),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(ec.pV)},this.onReceiveMessage=e=>{e.origin===window.location.origin&&((0,S.nq)()?(e.data.method===ec.RO&&window.parent.postMessage({method:ec.uL},window.location.origin),e.data.method===ec.wo&&e.data.speed&&(this.props.enableAutoplay(),this.props.updateAutoplaySpeed(e.data.speed),this.props.isAutoplayPaused&&this.toggleAutoplay()),e.data.method===ec.pV&&(this.props.disableAutoplay(),this.props.isAutoplayPaused||this.toggleAutoplay()),e.data.method===ec.G0&&this.toggleAutoplay(),e.data.method===ec.t0&&e.data.speed&&this.props.updateAutoplaySpeed(e.data.speed),e.data.method===ec.Gp&&(this.props.onItemEndReached?.(),this.props.updateIsAutoplayPaused(!1),this.scrollPage())):(this.props.isAutoplayEnabled&&e.data.method===ec.eh&&e.source?.postMessage({method:ec.wo,speed:this.props.autoplaySpeed}),e.data.method===ec.tu&&e.source?.postMessage({method:ec.RO}),e.data.method===ec.uL&&this.switchToNextItem(),e.data.method===ec.Q$&&"boolean"==typeof e.data.isPaused&&this.props.isAutoplayPaused!==e.data.isPaused&&this.props.updateIsAutoplayPaused(e.data.isPaused)))},this.shouldToggleAutoPlayControls=()=>!(0,S.nq)()||(0,S.nq)()&&(0,S.Fj)(),this.switchToNextItem=async e=>{await this.props.collectionBlock?.do("switchToNextItem",e),this.autoplayCollectionItem()},this.switchToFirstCollectionItem=()=>{this.switchToNextItem(0)},this.autoplayCollectionItem=()=>{clearTimeout(this.collectionTimeoutId);let e=ec.p4[this.props.autoplaySpeed].collectionAutoplayDuration;this.collectionTimeoutId=setTimeout(()=>{let e=this.props.collectionBlock?.do("getActiveItemBlock");if(!e)return;let t=e.do("isStoryMap"),s=e.do("getBlockItemType"),i=e.do("getItemUrl"),o=i?.startsWith(window?.origin);("embed"!==s||!o)&&(t&&o||this.switchToNextItem())},e)},this.postMessageToActiveItemIframe=(e,t)=>{let s=document.querySelector(`.${ec.d1}`)?.contentWindow;s?.postMessage({method:e,...t})},this.autoplayBriefingSlide=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=ec.p4[t.props.autoplaySpeed].briefingAutoplayDuration,i=t.props.briefingDisplay.totalNumberOfSlides,o=t.props.briefingDisplay.currentIndex,a=o===i-1,r=o+1;if(clearTimeout(t.briefingTimeoutId),e)return void t.props.updateBriefingDisplay({currentIndex:0});t.briefingTimeoutId=setTimeout(()=>{if(a)return t.jumpToTop();t.props.updateBriefingDisplay({currentIndex:r})},s)},this.toggleAutoplay=e=>{let t=!this.props.isAutoplayPaused;e?.preventDefault(),this.props.updateIsAutoplayPaused(t),this.props.collectionBlock?(this.postMessageToActiveItemIframe(ec.G0),t?clearTimeout(this.collectionTimeoutId):this.autoplayCollectionItem()):this.props.storyItem.type===v.z.Briefing?t?clearTimeout(this.briefingTimeoutId):this.autoplayBriefingSlide():(window.parent.postMessage({method:ec.Q$,isPaused:t}),this.scrollPage())},this.handleWindowScroll=e=>{(e.deltaY>0||e.deltaY<0)&&(this.updateScrollTime(),this.isReaderScrolling=!0,this.props.isAutoplayPaused||(this.props.updateIsAutoplayPaused(!0),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(ec.G0)))},this.handleMouseDown=e=>{this.props.isAutoplayPaused||this.autoplayNode.current?.contains(e.target)||(this.props.updateIsAutoplayPaused(!0),clearInterval(this.scrollTimer),clearTimeout(this.collectionTimeoutId),clearTimeout(this.briefingTimeoutId),this.postMessageToActiveItemIframe(ec.G0))},this.updateScrollTime=()=>{this.lastScrollTime=Date.now()},this.handleMouseMove=()=>{this.lastMouseMoveTime=Date.now(),this.setState({areAutoplayControlsShowing:!0})},this.interactionDelayCheck=()=>{if(!this.autoplayNode.current)return void clearInterval(this.interactionTimer);this.isReaderScrolling?this.onReaderScrolling():this.onReaderNotScrolling()},this.onReaderScrolling=()=>{Date.now()>this.lastScrollTime+ec.ak?this.isReaderScrolling=!1:this.setState({areAutoplayControlsShowing:!0})},this.onReaderNotScrolling=()=>{Date.now()>this.lastMouseMoveTime+ec.fo&&!this.props.isAutoplayPaused?this.setState({areAutoplayControlsShowing:!1}):this.setState({areAutoplayControlsShowing:!0})},this.toggleAutoplaySpeed=()=>{"fast"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("slow"):"slow"===this.props.autoplaySpeed?this.props.updateAutoplaySpeed("medium"):this.props.updateAutoplaySpeed("fast")},this.onResetClick=()=>{this.props.collectionBlock?(clearTimeout(this.collectionTimeoutId),this.switchToFirstCollectionItem(),this.postMessageToActiveItemIframe(ec.Gp),this.props.updateIsAutoplayPaused(!1)):this.props.storyItem.type===v.z.Briefing?(this.autoplayBriefingSlide(!0),this.props.updateIsAutoplayPaused(!1)):this.jumpToTop()},this.jumpToTop=()=>{this.props.onItemEndReached?.(),window.parent.postMessage({method:ec.tu},window.location.origin),this.props.updateIsAutoplayPaused(!1),this.scrollPage()},this.scrollPage=()=>{let e=ec.p4[this.props.autoplaySpeed].pageScrollDelay;clearInterval(this.scrollTimer),this.scrollTimer=window.setInterval(()=>{if(this.props.isAutoplayPaused||!this.autoplayNode.current)return void clearInterval(this.scrollTimer);0===window.scrollY?(clearInterval(this.scrollTimer),setTimeout(()=>{window.scrollBy(0,2),this.scrollPage()},2e3)):Math.round(window.innerHeight+window.scrollY)>=document.body.offsetHeight?(clearInterval(this.scrollTimer),setTimeout(this.jumpToTop,3e3)):window.scrollBy(0,2)},e)},this.state={areAutoplayControlsShowing:!1}}componentDidMount(){window.addEventListener("message",this.onReceiveMessage,!1),(0,S.nq)()&&window.parent.postMessage({method:ec.eh},window.location.origin)}componentDidUpdate(e,t){e.autoplaySpeed!==this.props.autoplaySpeed&&(this.scrollPage(),this.postMessageToActiveItemIframe(ec.t0,{speed:this.props.autoplaySpeed}),this.autoplayBriefingSlide()),!e.isAutoplayEnabled&&this.props.isAutoplayEnabled&&this.autoplayEnabledSetup(),e.isAutoplayEnabled&&!this.props.isAutoplayEnabled&&this.autoplayDisabledCleanup(),(0,S.nq)()&&!this.props.isAutoplayEnabled&&window.parent.postMessage({method:ec.eh},window.location.origin);let s=this.props.collectionDisplay.isCoverShowing;!e.collectionDisplay.isCoverShowing&&s&&this.props.isAutoplayEnabled&&this.props.disableAutoplay(),this.props.isAutoplayEnabled&&!this.props.isAutoplayPaused&&this.props.storyItem.type===v.z.Briefing&&this.props.briefingDisplay.currentIndex!==e.briefingDisplay.currentIndex&&this.autoplayBriefingSlide()}componentWillUnmount(){window.removeEventListener("message",this.onReceiveMessage,!1),this.autoplayDisabledCleanup()}render(){return this.props.isAutoplayEnabled?(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(ee.A,{triggerKey:" ",on:this.toggleAutoplay}),!this.props.isAutoplayPaused&&(0,o.jsx)(et.A,{isShowing:!0,isInvisible:!0}),(0,o.jsx)("div",{ref:this.autoplayNode,children:(0,o.jsx)(ep,{isShowing:this.shouldToggleAutoPlayControls()&&this.state.areAutoplayControlsShowing,speed:ec.p4[this.props.autoplaySpeed].displaySpeed,isPlaying:!this.props.isAutoplayPaused,onResetClick:this.onResetClick,onPlayToggle:this.toggleAutoplay,onSpeedToggle:this.toggleAutoplaySpeed})})]}):null}}let eh=(0,ei.A)((i=(0,F.B)((0,X.Lr)(ed)),class extends n.PureComponent{render(){return(0,o.jsx)(es.e.Consumer,{children:e=>(0,o.jsx)(i,{...this.props,...e})})}}));var em=s(400029),ey=s.n(em),eg=s(9600),eu=s(877494),ex=s(502648),ef=s(670673),eA=s(717236);let ew=e=>{let t=(0,N.cu)(),s=(0,g.df)().theme;return{currentWebsiteThemeColors:s.colors,currentThemeVariables:t,...(0,eA.G)({themeVariables:t,websiteTheme:s,flavor:e})}},eb=(0,n.forwardRef)((e,t)=>{let{className:s}=e,{foregroundColor:i}=ew(v.z.Briefing),{theme:a,productVariables:n}=(0,g.df)(),{isExpanded:l}=(0,q.Rq)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("header",{ref:t,...(0,eu.nf)(l),className:r().dynamic([["40c610947af28a30",[i,a.colors.backgroundOverlay,u.Ay.spacing.xxxxs,n.borderRadius.regular,n.borderRadius.regular,M.Ay.center()]]])+" "+(d()("briefing-compact-header",s)||""),children:(0,o.jsx)(ef.A,{})}),(0,o.jsx)(r(),{id:"40c610947af28a30",dynamic:[i,a.colors.backgroundOverlay,u.Ay.spacing.xxxxs,n.borderRadius.regular,n.borderRadius.regular,M.Ay.center()],children:`.briefing-compact-header.__jsx-style-dynamic-selector{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;color:${i};background-color:${a.colors.backgroundOverlay};padding:${u.Ay.spacing.xxxxs};-webkit-border-radius:0 0 ${n.borderRadius.regular} ${n.borderRadius.regular};-moz-border-radius:0 0 ${n.borderRadius.regular} ${n.borderRadius.regular};border-radius:0 0 ${n.borderRadius.regular} ${n.borderRadius.regular};${M.Ay.center()}}`})]})}),ev=()=>{let{hasSpaceForHeader:e}=(0,ex.N)(),[t,s]=(0,n.useState)(!0),i=(0,n.useRef)(null),a=(0,n.useRef)(null),l=(0,n.useCallback)(ey()(()=>{p(),i.current=setTimeout(()=>{c()},3e3)},20),[]);(0,n.useEffect)(()=>{if(!e)return window.addEventListener("mousemove",l),()=>{window.removeEventListener("mousemove",l)}},[e,l]);let p=()=>{s(!0),i.current&&clearTimeout(i.current)},c=()=>{s(!1)};if((0,eg.C)({triggerKey:["Enter"],hasPrimaryModifier:!0,hasShiftKey:!0,on:e=>{e.preventDefault(),l(),(0,eu.Su)(a.current)}}),e)return null;let h="briefing-conditional-compact-header",{className:m,styles:y}={styles:(0,o.jsx)(r(),{id:"65750f73aa1e6a54",dynamic:[h,10,h,h],children:`.${h}.__jsx-style-dynamic-selector{z-index:10;position:fixed;top:0;left:50%;-webkit-transform:translatex(-50%)translatey(-100%);-moz-transform:translatex(-50%)translatey(-100%);-ms-transform:translatex(-50%)translatey(-100%);-o-transform:translatex(-50%)translatey(-100%);transform:translatex(-50%)translatey(-100%);-webkit-transition:-webkit-transform.6s;-moz-transition:-moz-transform.6s;-o-transition:-o-transform.6s;transition:-webkit-transform.6s;transition:-moz-transform.6s;transition:-o-transform.6s;transition:transform.6s}.${h}.__jsx-style-dynamic-selector:is(.show,:focus-within){-webkit-transform:translatex(-50%)translatey(0);-moz-transform:translatex(-50%)translatey(0);-ms-transform:translatex(-50%)translatey(0);-o-transform:translatex(-50%)translatey(0);transform:translatex(-50%)translatey(0)}@media(prefers-reduced-motion:reduce){.${h}.__jsx-style-dynamic-selector{-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none}}`}),className:r().dynamic([["65750f73aa1e6a54",[h,10,h,h]]])};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eb,{className:d()(m,h,{show:t}),ref:a}),y]})};var eI=s(300600),eS=s(798488),eT=s(497077),ek=s(674772),eD=s(789016);let ej={phone:{landscape:{width:734,height:388,fileName:"frame-phone-landscape.png"},portrait:{width:388,height:734,fileName:"frame-phone.png"}},tablet:{landscape:{width:1100,height:782,fileName:"frame-tablet-landscape.png"},portrait:{width:782,height:1100,fileName:"frame-tablet.png"}},desktop:{landscape:{width:1370,height:878,fileName:"frame-desktop.png"},portrait:{width:1370,height:878,fileName:"frame-desktop.png"}}};class eC extends n.Component{constructor(e){super(e),this.margins={top:65,bottom:130,side:65},this.scaleWrapper=(0,n.createRef)(),this.scaledPreview=(0,n.createRef)(),this.previewIframe=(0,n.createRef)(),this.handleResize=()=>{this.forceUpdate()},this.findTransformScale=()=>{let e=this.scaleWrapper.current?.getBoundingClientRect();if(!e)return 1;let t=ej[this.props.device];return+Math.min(Math.min(Math.round(e.height-this.margins.top-this.margins.bottom)/t.portrait.height,1),Math.min(Math.round(e.width-2*this.margins.side)/t.landscape.width,1)).toFixed(2)},this.findTopPosition=e=>{if(!this.scaleWrapper.current||!this.scaledPreview.current)return 0;let t=Math.round(this.scaleWrapper.current.getBoundingClientRect().height),s=Math.round(e||this.scaledPreview.current.getBoundingClientRect().height);return this.margins.top+(t-s-this.margins.top-this.margins.bottom)/2},this.handleResizeDebouncedly=(0,ek.sg)(this.handleResize,200)}componentDidMount(){this.forceUpdate(),this.scrollWindowToTop(),window.addEventListener("resize",this.handleResizeDebouncedly)}componentDidUpdate(e){(e.device!==this.props.device||e.orientation!==this.props.orientation)&&this.scrollIframeToTop()}componentWillUnmount(){window.removeEventListener("resize",this.handleResizeDebouncedly)}render(){let e=ej[this.props.device][this.props.orientation],t=this.findTransformScale(),s=Math.round(e.height*t),i=this.findTopPosition(s),a=this.props.query?(0,eD.lK)(this.props.query):void 0,l=void 0===this.props.selectedItemId?a?`./embedded-preview?${a}`:"./embedded-preview":a?`./embedded-preview?item=${this.props.selectedItemId}&${a}`:`./embedded-preview?item=${this.props.selectedItemId}`;return(0,o.jsx)(n.Fragment,{children:(0,o.jsxs)("div",{ref:this.scaleWrapper,className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" "+`scale-wrapper ${this.props.device} ${this.props.orientation}`,children:[(0,o.jsx)("div",{className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" scaled",children:(0,o.jsx)("div",{ref:this.scaledPreview,className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" center-horizontally scaled-preview",children:(0,o.jsxs)("div",{className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" preview-container specified-dimensions",children:[(0,o.jsx)("img",{src:`${this.props.config.BASE_URL}/static/storymaps-website-common/images/device-preview/${e.fileName}`,alt:this.props.intl.formatMessage({id:"component.preview.chromeAlt"}),loading:"lazy",className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" device-chrome"}),(0,o.jsx)("iframe",{src:l,ref:this.previewIframe,loading:"lazy",className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])})]})})}),"desktop"!==this.props.device&&(0,o.jsx)("div",{className:r().dynamic([["2bbf832429ff2ae4",[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height]]])+" rotate-button-wrapper center-horizontally",children:(0,o.jsx)(er.Ay,{type:"single-icon",iconSize:24,onClick:this.props.onOrientationChange,visuallyHiddenLabel:this.props.intl.formatMessage({id:"component.preview.rotateLabel"}),children:(0,o.jsx)(R.A,{path:"M21.323 8.616l-4.94-4.94a1.251 1.251 0 0 0-1.767 0l-10.94 10.94a1.251 1.251 0 0 0 0 1.768l4.94 4.94a1.25 1.25 0 0 0 1.768 0l10.94-10.94a1.251 1.251 0 0 0 0-1.768zM14 5.707L19.293 11 11.5 18.793 6.207 13.5zm-4.323 14.91a.25.25 0 0 1-.354 0l-1.47-1.47.5-.5-2-2-.5.5-1.47-1.47a.25.25 0 0 1 0-.354L5.5 14.207l5.293 5.293zm10.94-10.94l-.617.616L14.707 5l.616-.616a.25.25 0 0 1 .354 0l4.94 4.94a.25.25 0 0 1 0 .353zm1.394 6.265V18a3.003 3.003 0 0 1-3 3h-3.292l1.635 1.634-.707.707-2.848-2.847 2.848-2.848.707.707L15.707 20h3.304a2.002 2.002 0 0 0 2-2v-2.058zM4 9H3V7a3.003 3.003 0 0 1 3-3h3.293L7.646 2.354l.707-.707 2.848 2.847L8.354 7.34l-.707-.707L9.28 5H6a2.002 2.002 0 0 0-2 2z"})})}),(0,o.jsx)(r(),{id:"2bbf832429ff2ae4",dynamic:[this.props.websiteDesign.theme.colors.backgroundSecondary,t,i,u.Ay.spacing.lg,this.props.device,this.props.orientation,e.width,e.height],children:`.center-horizontally.__jsx-style-dynamic-selector{position:absolute;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);top:0}.scale-wrapper.__jsx-style-dynamic-selector{height:100vh;position:relative;background-color:${this.props.websiteDesign.theme.colors.backgroundSecondary}}.scaled.__jsx-style-dynamic-selector{-webkit-transform:scale(${t});-moz-transform:scale(${t});-ms-transform:scale(${t});-o-transform:scale(${t});transform:scale(${t});position:relative;top:${i}px}.preview-container.__jsx-style-dynamic-selector{margin:0 auto}.rotate-button-wrapper.__jsx-style-dynamic-selector{top:auto;bottom:${u.Ay.spacing.lg}}iframe.__jsx-style-dynamic-selector{position:absolute;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.${this.props.device}.${this.props.orientation}.__jsx-style-dynamic-selector .specified-dimensions.__jsx-style-dynamic-selector{width:${e.width}px;height:${e.height}px}.phone.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.8%;left:1.9%;height:90.4%;width:96.3%}.phone.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.8%;top:1.9%;width:90.4%;height:96.3%}.tablet.portrait.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:4.6%;left:1.4%;height:90.6%;width:97.2%}.tablet.landscape.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{left:4.6%;top:1.4%;width:90.6%;height:97.2%}.desktop.__jsx-style-dynamic-selector iframe.__jsx-style-dynamic-selector{top:6.4%;left:1.8%;width:96.5%;height:90.9%}`})]})})}scrollWindowToTop(){let e=window?.document?.documentElement;e&&(e.scrollTop=0)}scrollIframeToTop(){try{let e=this.previewIframe?.current?.contentWindow?.document?.documentElement;e&&this.scrollToTop(e)}catch(e){}}scrollToTop(e){if(e.scrollTop>0){let t=e.clientHeight?Math.round(e.clientHeight/2):300;setTimeout(()=>{e.scrollBy(0,-1*t),this.scrollToTop(e)},10)}}}let e$=(0,g.NV)((0,p.Ay)((0,D.az)(eC)));var eL=s(698654),ez=s(470660),e_=s(398550),eM=s(917318),eE=s(656228),eR=s(263841),eP=s(801422);class eB extends n.Component{static #e=this.defaultProps={device:"fullscreen",onDeviceChange:()=>{}};render(){let e=this.props.intl.formatMessage({id:"component.preview.controls.close"});return(0,o.jsxs)("div",{className:r().dynamic([["d81dd0a8c94eda56",[M.Ay.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),M.Ay.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid]]])+" preview-controls",children:[this.deviceSpecs.map(e=>{if(e.isUnavailable)return;let t=e.value,s=this.props.intl.formatMessage({id:e.stringId});return(0,o.jsx)(eE.g,{"aria-pressed":this.props.device===t,iconProps:e.iconProps,buttonId:e.stringId,onClick:()=>{this.onPreviewChangeWrapper(t)},tooltipContent:s},`${t}-frag`)}),(0,o.jsx)(eR.A,{}),(0,o.jsxs)(eM.m_,{children:[(0,o.jsx)(eP.i,{routeDef:(0,U.WU)({route:"builder",itemId:this.props.storyItem.itemId,itemType:this.props.storyItem.type,isTemplate:this.props.storyItem.isTemplate}),children:(0,o.jsx)(eM.k$,{autoARIADescribedByEnabled:!1,children:(0,o.jsx)(er.Ay,{type:"single-icon",className:"edit-link",visuallyHiddenLabel:e,children:(0,o.jsx)(R.A,{path:_.s,size:16})})})}),(0,o.jsx)(eM.ZI,{children:e})]}),(0,o.jsx)(r(),{id:"d81dd0a8c94eda56",dynamic:[M.Ay.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"}),M.Ay.shadow.md(),this.props.websiteDesign.theme.colors.surfaceDefault,this.props.websiteDesign.productVariables.borderRadius.mid],children:`.preview-controls.__jsx-style-dynamic-selector{${M.Ay.gapped({direction:"horizontal",alignItems:"center",justifyContent:"center"})};${M.Ay.shadow.md()}            background-color: ${this.props.websiteDesign.theme.colors.surfaceDefault};-webkit-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};-moz-border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};border-radius:${this.props.websiteDesign.productVariables.borderRadius.mid};color:inherit}`})]})}constructor(...e){super(...e),this.deviceSpecs=[{value:"phone",iconProps:{path:eL.o},stringId:"component.previewHeader.device.phone",isUnavailable:this.props.storyItem.type===v.z.Briefing},{value:"tablet",iconProps:{path:"M15 14a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H1a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1zm-.25-10a.25.25 0 0 1 .25.25v8.5a.25.25 0 0 1-.25.25H14V4zM13 4v9H4V4zM1 9h1V8H1V4.25A.25.25 0 0 1 1.25 4H3v9H1.25a.25.25 0 0 1-.25-.25z",shouldFlipRTL:!0},stringId:"component.previewHeader.device.tablet",isUnavailable:this.props.storyItem.type===v.z.Briefing},{value:"desktop",iconProps:{path:ez.G},stringId:"component.previewHeader.device.desktop"},{value:"fullscreen",iconProps:{path:e_.U,shouldFlipRTL:!0},stringId:"component.previewHeader.device.full"}],this.onPreviewChangeWrapper=e=>{this.props.onDeviceChange&&this.props.onDeviceChange(e)}}}let eH=(0,g.NV)((0,D.az)((0,p.Ay)((0,V.Cm)((0,ei.e)(eB)))));var eN=s(623683),eO=s(971552),eU=s(54302),eV=s(602422),eW=s(142529),eF=s(777142),eG=s(20421);let eq=(e,t,s,i,o,a,r,n,l)=>JSON.stringify({"@context":"https://schema.org","@type":"NewsArticle",mainEntityOfPage:{"@type":"WebPage","@id":e},headline:`${a}`,image:[`${t}`],datePublished:`${s}`,dateModified:`${i}`,author:{"@type":"Person",name:`${o}`},publisher:{"@type":"Organization",name:"Esri",logo:{"@type":"ImageObject",url:`${n}${l.BASE_URL}/static/images/logo.png`}},description:`${r}`}),eK=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("link",{rel:"preconnect",href:"https://www.arcgis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://js.arcgis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://static.arcgis.com"})]}),eZ=e=>{let{publishedDate:t,host:s,config:i,authorTrackingConfig:a}=e,r=(0,J.ck)();if(r.type===v.z.Theme)throw Error("StoryItemMetaTags do not currently support theme items");let l=a&&(0,b.me)(a).isValidAnalyticsConfig,p=i.ESRI_MARKETING_ANALYTICS&&((r.itemDetails.typeKeywords??[]).includes(eF.AV)||"string"==typeof r.itemDetails.orgId&&i.ESRI_MARKETING_ANALYTICS.orgIds.includes(r.itemDetails.orgId))?i.ESRI_MARKETING_ANALYTICS.scriptSrc:void 0,{requestNextRouteChangeWithFullPageLoad:c,getUrlFromRouteDef:d}=(0,U.dA)();(0,n.useEffect)(()=>{(l||void 0!==p)&&c()},[l,p,c]);let h=(0,eN.A)(!0),y=`${s?"https://"+s:(0,eO.I)({siteUrl:i.SITE_URL,isComponentMounted:h,isScriptEmbedded:i.IS_SCRIPT_EMBEDDED})}`,g=(0,eU.Jc)({portalHost:i.PORTAL_HOST,itemDetails:r.itemDetails,fallbackUrl:`${y}${(0,eG.b9)(i.BASE_URL)}`,shouldIgnoreDPR:!0,returnOriginalAspectRatio:!0}),u=(0,k.T)(r.itemDetails),x=u?.metaProperties?.title?(0,eD.wr)(u?.metaProperties?.title):(0,eD.wr)(e.title),f=(0,eD.wr)(e.author),A=u?.metaProperties?.description?(0,eD.wr)(u?.metaProperties?.description):r.itemDetails.snippet?(0,eD.wr)(r.itemDetails.snippet):r.itemDetails.description?(0,eD.wr)(r.itemDetails.description):"",w=d((0,U.WU)({route:"viewer",itemType:r.type,itemId:r.itemDetails.id,isTemplate:r.isTemplate})),I=(0,eV.Y)({typeKeywords:r.itemDetails.typeKeywords,typeKeywordId:eW.aE})||!(0,eU.e5)({itemDetails:r.itemDetails,isTemplate:r.isTemplate})||e.isStandaloneBlock;return(0,o.jsxs)(m(),{children:[(0,o.jsx)("title",{children:x},"title"),(0,o.jsx)("meta",{name:"author",content:f},"author"),(0,o.jsx)("meta",{property:"article:published_time",content:t.toISOString()},"publishedDate"),(0,o.jsx)("link",{rel:"canonical",href:w}),(0,o.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:`${y}/oembed?url=${encodeURIComponent(w)}&format=json`,title:x}),(0,o.jsx)("link",{rel:"alternate",type:"text/xml+oembed",href:`${y}/oembed?url=${encodeURIComponent(w)}&format=xml`,title:x}),(0,o.jsx)(eK,{}),(void 0!==r.itemDetails.robots||I)&&(0,o.jsx)("meta",{name:"robots",content:I?"noindex, nofollow":"function"==typeof r.itemDetails.robots?.join?r.itemDetails.robots.join(","):"noindex, nofollow"}),(0,o.jsx)("meta",{property:"og:title",content:x},"og:title"),(0,o.jsx)("meta",{property:"og:description",content:A},"og:description"),(0,o.jsx)("meta",{property:"og:url",content:w},"og:url"),(0,o.jsx)("meta",{property:"og:image",content:g},"og:image"),(0,o.jsx)("meta",{name:"twitter:creator",content:f},"twitter:creator"),(0,o.jsx)("meta",{name:"twitter:url",content:w},"twitter:url"),(0,o.jsx)("meta",{name:"twitter:title",content:x},"twitter:title"),(0,o.jsx)("meta",{name:"twitter:description",content:A},"twitter:description"),(0,o.jsx)("meta",{name:"twitter:image",content:g},"twitter:image"),(0,o.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:`${eq(w,g,new Date(r.itemDetails.created).toISOString(),t.toISOString(),f,x,A,y,i)}`}}),p&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("script",{dangerouslySetInnerHTML:{__html:`(function(){window.dataLayer = Object.assign({}, window.dataLayer, {pageTitle: 'StoryMap: ${r.itemDetails.owner}: ' + document.title, pageName: 'StoryMap: ' + document.title, pageType: 'StoryMaps', pageSubType: 'StoryMap', domain: window.location.host, language: 'en',countryCode: 'us'});})()`}}),(0,o.jsx)("script",{src:p,async:!0})]})]})};var eY=s(536275),eJ=s(458151);let eQ=()=>{let{updateAppOffsetValues:e,top:t}=(0,V.k3)();return(0,n.useEffect)(()=>{t!==eJ.q8&&e({top:{storyHeader:(0,eD.U)(eJ.q8)}})},[]),null},eX=e=>{let{shouldShowHeader:t,children:s}=e,{hasSpaceForHeader:i,toggleHeaderSpace:a}=(0,ex.N)();return(0,o.jsxs)(o.Fragment,{children:[t&&(0,o.jsx)(eQ,{}),(0,o.jsx)(ee.A,{triggerKey:"\\",isMeta:!0,on:a}),i&&s]})};var e0=s(539248),e1=s(151130),e5=s(952623);let e2=e=>(0,o.jsx)(er.Ay,{type:"secondary",className:e.className,onClick:()=>window.history.back(),children:(0,o.jsx)(l.A,{id:"page.error.back"})});class e8 extends n.PureComponent{render(){return(0,o.jsx)(er.Ay,{className:this.props.className,onClick:this.print,children:(0,o.jsx)(l.A,{id:"common.print"})})}constructor(...e){super(...e),this.print=()=>{I.A.trackEvent(I.A.Category.Viewer,I.A.Action.Viewer_Print),window.print()}}}let e3=()=>{let e={styles:(0,o.jsx)(r(),{id:"a6ce1c94bf74f55a",dynamic:[u.Ay.spacing.xs],children:`.side-margins.__jsx-style-dynamic-selector{margin:0 ${u.Ay.spacing.xs}}`}),className:r().dynamic([["a6ce1c94bf74f55a",[u.Ay.spacing.xs]]])};return(0,o.jsxs)("div",{className:r().dynamic([["a89ba1f1b9d8a10d",[u.Ay.spacing.lg,u.Ay.spacing.xs,x.Gs.RTL]]])+" basic-wrapper",children:[(0,o.jsxs)("div",{className:r().dynamic([["a89ba1f1b9d8a10d",[u.Ay.spacing.lg,u.Ay.spacing.xs,x.Gs.RTL]]])+" print-wrapper",children:[(0,o.jsx)(e8,{className:`side-margins ${e.className}`}),(0,o.jsx)(e2,{className:`side-margins ${e.className}`})]}),(0,o.jsx)(r(),{id:"a89ba1f1b9d8a10d",dynamic:[u.Ay.spacing.lg,u.Ay.spacing.xs,x.Gs.RTL],children:`.basic-wrapper.__jsx-style-dynamic-selector{position:relative;display:none}@media screen{.basic-wrapper.__jsx-style-dynamic-selector{display:block}}.print-wrapper.__jsx-style-dynamic-selector{position:absolute;top:${u.Ay.spacing.lg};left:100%;display:grid;grid-gap:${u.Ay.spacing.xs}}${x.Gs.RTL} .print-wrapper.__jsx-style-dynamic-selector{left:unset;right:100%}`}),e.styles]})},e4=e=>{let{isScriptEmbed:t}=e,{vertical:s}=(0,V.k3)(),i=d()("viewer-main",eF.TL,e.mainClassName,{"device-preview":"preview"===e.mode});return(0,o.jsxs)(e5.A,{className:d()({"inline-story":e.isInlineStory}),children:[e.viewerHeader,e.printMode&&(0,o.jsx)(e3,{}),(0,o.jsx)(t?"div":"main",{className:r().dynamic([["5071f519c7bf51f8",[u.Ay.print.pageWidthLetter,u.Ay.print.backgroundColor]],["a550cc54139b2c85",[s,s]]])+" "+(i||""),children:e.children}),(0,o.jsx)(r(),{id:"a550cc54139b2c85",dynamic:[s,s],children:`.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100vh - ${s});min-height:-moz-calc(100vh - ${s});min-height:calc(100vh - ${s})}.viewer-main.device-preview.__jsx-style-dynamic-selector{min-height:0}body.print .viewer-main.__jsx-style-dynamic-selector{min-height:0}@supports(height:1svh){.viewer-main.__jsx-style-dynamic-selector{min-height:-webkit-calc(100svh - ${s});min-height:-moz-calc(100svh - ${s});min-height:calc(100svh - ${s})}}`}),(0,o.jsx)(r(),{id:"5071f519c7bf51f8",dynamic:[u.Ay.print.pageWidthLetter,u.Ay.print.backgroundColor],children:`body.print{width:${u.Ay.print.pageWidthLetter};margin:0 auto}body.print .page-container{background:${u.Ay.print.backgroundColor}}`})]})};var e7=s(702289);class e6 extends n.PureComponent{constructor(e){super(e),this.setAuthorTrackerFromConfig=()=>{this.trackingDetails=this.getAuthorTrackerDetails(),this.trackingType=this.trackingDetails?.type;let e=(0,b.me)(this.trackingDetails);if(void 0!==this.trackingDetails&&!this.state.hasActiveAuthorTracker&&e.isValidAnalyticsConfig){b.IO.setup({portal:this.props.portalSelfResponse,isPortal:this.props.isPortal,authorTrackingConfig:this.trackingDetails});try{b.IO.instance.startupTracker(),this.setState({hasActiveAuthorTracker:!0})}catch(e){this.setState({hasActiveAuthorTracker:!1}),console.error("Error starting author tracker",e)}}},this.handleEmbeddedCollectionUpdate=e=>{let{currentIndex:t,isItemViewTransitionComplete:s,isCoverShowing:i}=e.detail;this.props.collectionDisplay.updateCollectionDisplay({currentIndex:t,isItemViewTransitionComplete:s,isCoverShowing:i})},this.getItemViewerHeader=()=>{let e=this.props.storyItem.getItemPublishStatus(),t=this.props.storyItem.itemSharingLevel,s=this.props.storyItem.itemDetails&&"embedded-preview"!==this.props.mode&&"preview"!==this.props.mode&&!this.props.storyItem.itemDetails.origin&&("admin"===this.props.storyItem.itemDetails.itemControl||"update"===this.props.storyItem.itemDetails.itemControl),i={...this.props,storyId:this.props.storyItem.itemId,title:this.state.title,isOrgItem:this.props.storyItem.isOrgItem,itemOwner:this.props.storyItem.itemOwner,storyType:this.props.itemType,publishStatus:e,sharingLevel:t,canEdit:s,areSocialIconsHidden:this.state.areSocialIconsHidden,appLogo:this.props.appLogo,shouldShowSkipLink:!0,hashForSkipLink:this.state.hashForSkipLink,shouldShowLogoInHeader:this.props.storyContext.storyLogo?.shouldShowLogoInHeader??!0};switch(this.props.itemType){case v.z.Story:return(0,o.jsx)(eY.A,{...i,canShowItemTitle:this.props.canShowItemTitle,onTitleClicked:this.resetItemBlock});case v.z.Collection:return(0,o.jsx)(eT.A,{...i,canShowItemTitle:this.props.canShowItemTitle,getItemHref:this.getItemHref,isScriptEmbed:this.props.isScriptEmbed});case v.z.Briefing:return(0,o.jsx)(eI.A,{...i,onTitleClicked:this.resetItemBlock,shouldDisablePresentationModeUI:this.getIsEmbeddedPreview()});case v.z.Frame:return(0,o.jsx)(o.Fragment,{});default:throw Error("No story item type provided")}},this.getBannerStringId=()=>this.props.itemType===v.z.Frame?"frames.preview.banner":"common.banner.viewDraftStory.mobile",this.getItemHref=e=>this.itemBlock?.do("getItemUrl",e),this.renderBanner=e=>(0,o.jsxs)(n.Fragment,{children:["fullscreen-preview"===e&&(!this.props.isViewportMinWidth("large")||this.props.itemType===v.z.Frame)&&(0,o.jsx)("div",{className:r().dynamic([["445447b8254383ec",[this.props.appOffset.top]]])+" draft-preview-banner",children:(0,o.jsx)(y.A,{size:"small",title:(0,o.jsx)(l.A,{id:this.getBannerStringId()}),backgroundColor:this.props.websiteDesign.theme.colors.interactiveDefault,textColor:this.props.websiteDesign.theme.colors.labelReverse,closeBtnColor:this.props.websiteDesign.theme.colors.labelReverse,closeButtonLabel:this.props.intl.formatMessage({id:"common.close"})})}),(0,o.jsx)(r(),{id:"445447b8254383ec",dynamic:[this.props.appOffset.top],children:`.draft-preview-banner.__jsx-style-dynamic-selector{position:absolute;top:${this.props.appOffset.top};left:0;width:100%;z-index:1}body.print .draft-preview-banner.__jsx-style-dynamic-selector{display:none}body.frame{-webkit-touch-callout:none;-webkit-user-select:none}`})]}),this.renderBody=e=>"preview"===e&&"fullscreen"!==this.state.previewDevice?(0,o.jsx)(e$,{device:this.state.previewDevice,orientation:this.state.previewOrientation,onOrientationChange:this.onOrientationChange,query:this.props.query,...this.props.itemType===v.z.Collection&&{selectedItemId:(this.state.collectionItemIndex+1).toString()}}):(0,o.jsxs)(o.Fragment,{children:[this.state.ui,this.renderBanner(e)]}),this.onOrientationChange=()=>{let e="landscape"===this.state.previewOrientation?"portrait":"landscape";this.setState({previewOrientation:e})},this.onPreviewDeviceChange=e=>{if(e){let t={previewDevice:e};"phone"===e?(Object.assign(t,{previewOrientation:"portrait"}),I.A.trackEvent(I.A.Category.Preview,I.A.Action.Preview_Device_Phone)):"tablet"===e&&(Object.assign(t,{previewOrientation:"landscape"}),I.A.trackEvent(I.A.Category.Preview,I.A.Action.Preview_Device_Tablet)),this.setState(t,()=>{this.props.onPreviewDeviceChange?.(e)})}},this.resetItemBlock=()=>{this.itemBlock?.do("reset")},this.getAuthorTrackerDetails=()=>{let e=!this.props.environment.isPortal||this.props.featureDecisions.canHaveAuthorAnalytics,t=(0,e0.Oh)(this.props.storyItem,e,this.props.printMode);if("view"===this.props.mode&&t&&(!(t&&t.consentMessage)||this.state.hasUserAcceptedAuthorAnalytics))return t},this.onAuthorAnalyticsConsentMessageAccepted=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!0},()=>{this.setAuthorTrackerFromConfig()})},this.onAuthorAnalyticsConsentMessageDismissed=()=>{this.setState({isAuthorAnalyticsConsentMessageShowing:!1})},this.jumpToBlock=()=>{let e=100*(this.props.itemType!==v.z.Briefing),t=0,s=0,i=document.body.offsetHeight,o=setInterval(async()=>{s++;let e=document.body.offsetHeight;e===i?t++:(i=e,t=0),(t>=30||s>=100)&&(clearInterval(o),(0,e0.FL)(),this.state.linkedBlockId&&await this.itemBlock?.do("jumpToBlock",this.state.linkedBlockId))},e)},this.getHasDocumentLoaded=()=>"undefined"!=typeof document&&"complete"===document.readyState,this.onWindowLoaded=()=>{this.setState({hasPageLoaded:!0}),this.state.linkedBlockId&&this.state.hasItemRendered&&this.jumpToBlock()},this.getIsEmbeddedPreview=()=>(0,S.nq)()&&"embedded-preview"===this.props.mode,this.getBylineFromStoryItemData=(e,t,s)=>{if(t===v.z.Story){let t=e.nodes[e.root];if(!t.children)return"";for(let s of t.children){let t=e.nodes[s];if(t&&"storycover"===t.type)return t.data?.byline}}else if(t===v.z.Collection){for(let t of Object.values(e.nodes))if(t&&"collection-cover"===t.type)return t.data?.byline}else if(t===v.z.Frame)return s||"";else if(t===v.z.Briefing){for(let t of Object.values(e.nodes))if(t&&"storycover"===t.type)return t.data?.byline}else throw Error("only call getBylineFromStoryItemData for gemini items");return""},this.state={ui:void 0,viewerHeaderTheme:this.props.itemType===v.z.Briefing?"dark":"light",title:this.props.storyItem.itemDetails?.title||"",areSocialIconsHidden:!1,previewDevice:"fullscreen",previewOrientation:"landscape",isMounted:!1,isAuthorAnalyticsConsentMessageShowing:!1,hasUserAcceptedAuthorAnalytics:!1,hasActiveAuthorTracker:!1,hasPageLoaded:this.getHasDocumentLoaded(),linkedBlockId:this.props.canJumpToLinkedBlock&&!this.props.printMode?(0,e0.QI)():void 0,hasItemRendered:!1,collectionItemIndex:this.props.initialCollectionItemIndex??-1};let t=this.props.scriptEmbedConfig?.standalone??[].concat(this.props.query?.standalone)[0];this.renderData=function(e){let{standaloneId:t,itemData:s}=e;if(!t||!(0,L.f7)(s))return{isStandaloneBlock:!1,itemData:s};let i=s.nodes[t];if(!i||z.includes(i.type))return{isStandaloneBlock:!1,itemData:s};let o=s.root,a=s.nodes[o];if("story"!==a.type)return{isStandaloneBlock:!1,itemData:s};let r=(0,$.r8)(),n={type:"standalone",data:{originalRootId:o,storyTheme:a.data&&"storyTheme"in a.data?a.data.storyTheme:void 0},children:[t]},l=structuredClone(s);return l.root=r,l.nodes[r]=n,{isStandaloneBlock:!0,itemData:l}}({standaloneId:t,itemData:"view"===this.props.mode?this.props.storyItem.itemData:this.props.storyItem.itemDraftData})}componentDidMount(){(0,e7.m)(this),this.setState({isMounted:!0}),this.state.linkedBlockId&&(this.getHasDocumentLoaded()?this.onWindowLoaded():window.addEventListener("load",this.onWindowLoaded)),this.props.itemType===v.z.Collection&&document.addEventListener("embeddedCollectionUpdate",this.handleEmbeddedCollectionUpdate);let e=this.renderData?.itemData,t={shouldHideItemActions:this.props.storyItem.itemId===e1.p8||this.props.shouldHideItemActions||!!this.props.printMode||"view"!==this.props.mode,printMode:this.props.printMode,viewMode:this.props.mode,lazy:!this.props.printMode,storyItem:this.props.storyItem,config:this.props.config,featureDecisions:this.props.featureDecisions,environment:this.props.environment,toast:this.props.toast,portalSelfResponse:this.props.portalSelfResponse,authManager:this.props.authManager,getIntl:()=>this.props.intl,getAppOffset:()=>this.props.appOffset,getStoryOffset:()=>this.props.storyOffsetContext,getStoryDesignContext:()=>this.props.storyDesign,getStoryRouting:()=>this.props.storyRouting,getStoryContext:()=>this.props.storyContext,root:{initialThemeItemInfo:this.props.initialThemeItemInfo},scriptEmbedConfig:this.props.scriptEmbedConfig,canCopyLinks:!this.props.isInlineStory&&!(0,S.Fj)(),...this.props.itemType===v.z.Collection&&{lazy:!1,getCollectionContextDisplay:()=>this.props.collectionDisplay,getCollectionContextData:()=>this.props.collectionData,isShowingCollectionItem:!this.props.collectionDisplay.isCoverShowing}};window.location.search.includes("lazy=false")&&Object.assign(t,{lazy:!1}),Object.assign(t,{lab:this.props.config.ENABLE_LAB_FEATURES&&(0,T.DN)(window.location.href)}),document&&document.body&&this.props.printMode&&document.body.classList.add("print",this.props.printMode),document&&document.body&&this.props.itemType===v.z.Frame&&document.body.classList.add("frame"),(0,C.jq)({data:e,mode:"viewer",context:{...t},registry:(0,O.G)({featureDecisions:this.props.featureDecisions,includeLabItems:!!t.lab})}).then(e=>{this.itemBlock=e;let t=this.itemBlock.do("getStoryTheme");return this.setState({viewerHeaderTheme:this.props.itemType===v.z.Briefing?"dark":t.websiteThemeFlavor,title:this.itemBlock.do("getCoverTitle"),areSocialIconsHidden:this.itemBlock.do("isSocialIconsHidden"),coverData:this.itemBlock.do("getCoverData"),hashForSkipLink:this.itemBlock.do("getSkipLinkHash")}),this.itemBlock.render()}).then(e=>{this.setAuthorTrackerFromConfig(),this.setState({ui:e,hasItemRendered:!0,isAuthorAnalyticsConsentMessageShowing:"view"===this.props.mode&&!this.props.printMode&&!!this.itemBlock?.do("getAuthorAnalytics")&&!!(this.itemBlock?.do("getAuthorAnalytics")).consentMessage}),this.state.linkedBlockId&&this.state.hasPageLoaded&&this.jumpToBlock()}).then(()=>{if("view"===this.props.mode&&this.props.storyItem.itemId!==e1.p8)try{(0,W.eD)({itemId:this.props.storyItem.itemId,portalHost:this.props.config.PORTAL_HOST,authManager:this.props.authManager,customTracker:this.props.itemViewTracker})}catch(e){}}).catch(e=>{I.A.trackEvent(I.A.Category.Viewer,I.A.Action.Story_Render_Error,this.props.storyItem.itemId),this.props.redirectOnLoadError?.({config:this.props.config,signInUrl:this.props.signInUrl,authManager:this.props.authManager})})}componentDidUpdate(e){if(this.props.itemType===v.z.Collection){let{currentIndex:t,isCoverShowing:s,isItemViewTransitionComplete:i}=e.collectionDisplay,{currentIndex:o,isCoverShowing:a,isItemViewTransitionComplete:r}=this.props.collectionDisplay,n=s!==a||t!==o,l=n||i!==r;if(this.getIsEmbeddedPreview()&&l){let e=new CustomEvent("embeddedCollectionUpdate",{detail:{currentIndex:o,isItemViewTransitionComplete:r,isCoverShowing:a}});try{window.parent?.document.dispatchEvent(e)}catch{}return}if(n){let e=this.props.storyItem.itemDetails.id,t=`${this.props.config.BASE_URL}/collections/${e}`;if("preview"===this.props.mode&&(t=`${t}/preview`),!a){let e=new URLSearchParams(window.location.search);e.set("item",`${o+1}`),t=`${t}?${e}`}this.props.isScriptEmbed||window.history.replaceState(null,"",t)}if("fullscreen"!==this.state.previewDevice)return;let p=a?-1:o;this.state.collectionItemIndex!==p&&this.setState({collectionItemIndex:p})}}componentWillUnmount(){this.setState({isMounted:!1}),window.removeEventListener("load",this.onWindowLoaded),document.removeEventListener("embeddedCollectionUpdate",this.handleEmbeddedCollectionUpdate)}render(){let e=this.itemBlock?.do("getMetaSettings"),t=(0,e0.UK)({itemType:this.props.itemType,isTemplate:this.props.storyItem.isTemplate,title:e?.title??this.state.title,formatMessage:this.props.intl.formatMessage}),s=this.props.mode;"preview"!==this.props.mode||"fullscreen"!==this.state.previewDevice&&this.props.isViewportMinWidth("large")||(s="fullscreen-preview");let i=!this.props.printMode&&("preview"===this.props.mode||"fullscreen-preview"===this.props.mode&&this.props.isViewportMinWidth("large")),a=this.props.shouldShowViewerHeader&&("preview"!==this.props.mode||"preview"===this.props.mode&&"fullscreen"===this.state.previewDevice),l=null;if(a){let e=this.getItemViewerHeader();l=(0,o.jsx)(g.Pl,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:this.props.itemType===v.z.Briefing?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eX,{shouldShowHeader:!0,children:e}),this.props.isViewportMinWidth("medium")&&(0,o.jsx)(ev,{})]}):e})}let p=(0,k.T)(this.props.storyItem.itemDetails),c=p?.metaProperties?.description||this.props.storyItem.itemDetails.snippet,h={styles:(0,o.jsx)(r(),{id:"5d5e70ea4ad4485d",dynamic:[this.props.websiteDesign.theme.colors.backgroundPrimary],children:`.briefing-viewer-main.__jsx-style-dynamic-selector{background-color:${this.props.websiteDesign.theme.colors.backgroundPrimary}}`}),className:r().dynamic([["5d5e70ea4ad4485d",[this.props.websiteDesign.theme.colors.backgroundPrimary]]])},y=this.props.itemType===v.z.Story||this.props.itemType===v.z.Briefing||this.props.itemType===v.z.Frame,f=this.state.hasItemRendered&&!this.props.printMode&&this.props.postStoryContent,A=this.props.multiLang?.supportedLanguages?.filter(e=>!e.hasDetachedFromSource)??[],w=!!(c||A.length>1);return(0,o.jsxs)(n.Fragment,{children:[(0,o.jsx)(eS.A,{children:t}),w&&(0,o.jsxs)(m(),{children:[c&&(0,o.jsx)("meta",{name:"description",content:c,className:r().dynamic([["77de80ea438a6202",[this.props.appOffset.bottom,u.Ay.spacing.md,u.Ay.spacing.custom("7.2rem"),x.Gs.RTL,u.Ay.spacing.custom("7.2rem")]]])},"description"),A.length>1&&A.map(e=>(0,o.jsx)("link",{rel:"alternate",hrefLang:e.culture,href:`${this.props.config.SITE_URL}/${(0,Z.i)(this.props.storyItem.type,!1)}/${e.id}`,className:r().dynamic([["77de80ea438a6202",[this.props.appOffset.bottom,u.Ay.spacing.md,u.Ay.spacing.custom("7.2rem"),x.Gs.RTL,u.Ay.spacing.custom("7.2rem")]]])},`translation-${e.id}`))]}),y&&(0,o.jsx)(H.A,{}),(0,o.jsx)(J.Ay.Provider,{value:this.props.storyItem,children:(0,o.jsx)(X.Tt,{initialQuery:this.props.query,children:(0,o.jsx)(q.BN,{children:(0,o.jsxs)(G.No,{children:[this.props.storyItem.itemDetails&&this.props.storyItem&&this.props.storyItem.itemData&&this.props.storyItem.getItemPublishDate()&&(0,o.jsx)(eZ,{title:t,author:this.getBylineFromStoryItemData(this.props.storyItem.itemData,this.props.itemType,this.props.itemOwnerFullName),publishedDate:this.props.storyItem.getItemPublishDate(),host:this.props.host,config:this.props.config,authorTrackingConfig:this.getAuthorTrackerDetails(),isStandaloneBlock:this.renderData?.isStandaloneBlock}),this.state.isAuthorAnalyticsConsentMessageShowing&&(0,o.jsx)(B,{onAllowClicked:this.onAuthorAnalyticsConsentMessageAccepted,onDismissClicked:this.onAuthorAnalyticsConsentMessageDismissed,message:this.itemBlock?.do("getAuthorAnalytics")?.consentMessage??""}),(0,o.jsxs)(e4,{...this.props,viewerHeader:l,mode:s,printMode:this.props.printMode,isInlineStory:this.props.isInlineStory,isScriptEmbed:this.props.isScriptEmbed,mainClassName:this.props.itemType===v.z.Briefing?d()(h.className,"briefing-viewer-main"):void 0,children:[(0,o.jsx)(eh,{onItemEndReached:this.resetItemBlock,collectionBlock:this.props.itemType===v.z.Collection?this.itemBlock:void 0}),i&&this.props.isViewportMinWidth("large")&&this.state.isMounted&&this.props.itemType!==v.z.Frame&&(0,o.jsx)("div",{className:r().dynamic([["77de80ea438a6202",[this.props.appOffset.bottom,u.Ay.spacing.md,u.Ay.spacing.custom("7.2rem"),x.Gs.RTL,u.Ay.spacing.custom("7.2rem")]]])+" preview-controls-container",children:(0,o.jsx)(g.Pl,{defaultTheme:"light",children:(0,o.jsx)(eH,{onDeviceChange:this.onPreviewDeviceChange,device:this.state.previewDevice})})}),this.renderBody(s),this.props.footerBanner,f&&(0,o.jsx)(g.Pl,{defaultTheme:this.state.viewerHeaderTheme,isStoryThemeDependent:!0,children:this.props.postStoryContent})]})]})})})}),(0,o.jsx)(r(),{id:"77de80ea438a6202",dynamic:[this.props.appOffset.bottom,u.Ay.spacing.md,u.Ay.spacing.custom("7.2rem"),x.Gs.RTL,u.Ay.spacing.custom("7.2rem")],children:`.preview-controls-container.__jsx-style-dynamic-selector{position:fixed;z-index:98;bottom:-webkit-calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.md});bottom:-moz-calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.md});bottom:calc(${this.props.appOffset.bottom} + ${u.Ay.spacing.md});right:${u.Ay.spacing.custom("7.2rem")}}${x.Gs.RTL} .preview-controls-container.__jsx-style-dynamic-selector{right:unset;left:${u.Ay.spacing.custom("7.2rem")}}`}),this.props.itemType===v.z.Briefing&&h.styles]})}}let e9=(0,N.ng)((0,g.NV)((0,D.az)((0,p.Ay)((0,U.PX)((0,Q.N)((0,j.Fo)((0,V.Cm)((0,f.hB)((0,A.Ay)((0,w.S9)((0,Y.o)((0,F.B)((0,K.ZK)(e6))))))))))))))},65090:(e,t,s)=>{s.d(t,{e:()=>i});let i="M8.717 8.959L9 8c-1.03-.305-2.194-.84-3.084-1.558A9.587 9.587 0 0 0 8 3h1V2H5.572L4.198.552l-.724.687.721.761H1v1h1c.404 1.038 1.232 2.33 2.418 3.477C3.577 7.174 2.227 7.695 1.009 8l.242.97c1.429-.357 2.957-.986 3.924-1.818 1 .823 2.317 1.445 3.542 1.807zM3.087 3H6.94a8.668 8.668 0 0 1-1.775 2.777C4.208 4.864 3.5 3.855 3.088 3zM14.02 15.995l.91-.416L11 7.5l-4 8.072.904.428.899-2h4.306l.91 1.995zM9.275 13L11 9.5l1.652 3.5H9.275z"},99760:(e,t,s)=>{s.d(t,{M:()=>i});let i="M22.719 12A10.719 10.719 0 0 1 1.28 12h.838a9.916 9.916 0 1 0 1.373-5H8v1H2V2h1v4.2A10.71 10.71 0 0 1 22.719 12z"},166839:(e,t,s)=>{s.d(t,{v:()=>i});let i="M8 15H3.5A2.502 2.502 0 0 1 1 12.5v-9A2.502 2.502 0 0 1 3.5 1h9A2.502 2.502 0 0 1 15 3.5V8h-1V3.5A1.502 1.502 0 0 0 12.5 2h-9A1.502 1.502 0 0 0 2 3.5v9A1.502 1.502 0 0 0 3.5 14H8zm-.038-4.811a9.77 9.77 0 0 1-3.766 1.796l-.242-.97a8.816 8.816 0 0 0 3.282-1.532A9.264 9.264 0 0 1 4.888 5H4V4h3.279l-.544-.544.707-.707L8.692 4H12v1h-.914A9.836 9.836 0 0 1 9.78 8.152a3.853 3.853 0 0 0-1.82 2.037zm.032-1.383A8.167 8.167 0 0 0 10.058 5H5.922a8.18 8.18 0 0 0 2.072 3.806zM23 20.447v-8.894A2.525 2.525 0 0 0 20.484 9h-8.931A2.556 2.556 0 0 0 9 11.553v8.894A2.556 2.556 0 0 0 11.553 23h8.894A2.556 2.556 0 0 0 23 20.447zM20.484 10A1.517 1.517 0 0 1 22 11.516v8.968A1.517 1.517 0 0 1 20.484 22h-8.968A1.517 1.517 0 0 1 10 20.484v-8.968A1.517 1.517 0 0 1 11.516 10zm-2.086 8h-4.796l-1.159 2.23-.886-.46L16 11.215l4.443 8.555-.886.46zm-.52-1L16 13.385 14.122 17z"},207664:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(406029),o=s(94588),a=s.n(o),r=s(455729),n=s(332988),l=s.n(n),p=s(126966);let c=(0,r.memo)(e=>{let{isShowing:t,toggleStoryOverlay:s,isInvisible:o}=e,{backgroundColor:n}=(0,p.cu)(),[c,d]=(0,r.useState)(t);(0,r.useEffect)(()=>{t&&d(!0)},[t]);let h=async()=>{s&&(window.scrollTo(0,0),await s(!1),t||d(!1))};return(0,i.jsxs)(i.Fragment,{children:[c&&(0,i.jsx)("div",{onAnimationEnd:h,className:a().dynamic([["a2d1bc1c03a29693",[n,+!o]]])+" "+(l()("story-overlay",{"fade-in":!o&&t,"fade-out":!o&&!t})||"")}),(0,i.jsx)(a(),{id:"a2d1bc1c03a29693",dynamic:[n,+!o],children:`.story-overlay.__jsx-style-dynamic-selector{background-color:${n};position:fixed;width:100%;height:100%;top:0;left:0;right:0;bottom:0;z-index:2;opacity:${+!o};pointer-events:none}.fade-in.__jsx-style-dynamic-selector{-webkit-animation:fadeIn 250ms ease-in;-moz-animation:fadeIn 250ms ease-in;-o-animation:fadeIn 250ms ease-in;animation:fadeIn 250ms ease-in}@-webkit-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}100%{opacity:1}}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}.fade-out.__jsx-style-dynamic-selector{-webkit-animation:fadeOut 250ms ease-out;-moz-animation:fadeOut 250ms ease-out;-o-animation:fadeOut 250ms ease-out;animation:fadeOut 250ms ease-out}@-webkit-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-moz-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@-o-keyframes fadeOut{0%{opacity:1}100%{opacity:0}}@keyframes fadeOut{0%{opacity:1}100%{opacity:0}}`})]})})},278040:(e,t,s)=>{s.d(t,{k:()=>i});let i="M2 5v22h28V5zm1 21V6h9v20zm26 0H13V6h16zM4 17h5v1H4zm0-3h7v1H4z"},372805:(e,t,s)=>{s.d(t,{R:()=>i});let i="M9.5 2h-6A1.502 1.502 0 0 0 2 3.5v6A1.502 1.502 0 0 0 3.5 11h6A1.502 1.502 0 0 0 11 9.5v-6A1.502 1.502 0 0 0 9.5 2zm.5 7.5a.501.501 0 0 1-.5.5h-6a.501.501 0 0 1-.5-.5v-6a.501.501 0 0 1 .5-.5h6a.501.501 0 0 1 .5.5zM20.5 2h-6A1.502 1.502 0 0 0 13 3.5v6a1.502 1.502 0 0 0 1.5 1.5h6A1.502 1.502 0 0 0 22 9.5v-6A1.502 1.502 0 0 0 20.5 2zm.5 7.5a.501.501 0 0 1-.5.5h-6a.501.501 0 0 1-.5-.5v-6a.501.501 0 0 1 .5-.5h6a.501.501 0 0 1 .5.5zM9.5 13h-6A1.502 1.502 0 0 0 2 14.5v6A1.502 1.502 0 0 0 3.5 22h6a1.502 1.502 0 0 0 1.5-1.5v-6A1.502 1.502 0 0 0 9.5 13zm.5 7.5a.501.501 0 0 1-.5.5h-6a.501.501 0 0 1-.5-.5v-6a.501.501 0 0 1 .5-.5h6a.501.501 0 0 1 .5.5zM20.5 13h-6a1.502 1.502 0 0 0-1.5 1.5v6a1.502 1.502 0 0 0 1.5 1.5h6a1.502 1.502 0 0 0 1.5-1.5v-6a1.502 1.502 0 0 0-1.5-1.5zm.5 7.5a.501.501 0 0 1-.5.5h-6a.501.501 0 0 1-.5-.5v-6a.501.501 0 0 1 .5-.5h6a.501.501 0 0 1 .5.5z"},398550:(e,t,s)=>{s.d(t,{U:()=>i});let i="M0 1v14h16V1zm1 13V5h4v9zm14 0H6V5h9zm0-10h-1V3h-1v1H1V2h14z"},405898:(e,t,s)=>{s.d(t,{M:()=>i});let i="M5 9H1.833A.834.834 0 0 1 1 8.167V1.833A.834.834 0 0 1 1.833 1h6.334A.834.834 0 0 1 9 1.833V5h1V1.833A1.835 1.835 0 0 0 8.167 0H1.833A1.835 1.835 0 0 0 0 1.833v6.334A1.835 1.835 0 0 0 1.833 10H5zm1.733-3.956A6.467 6.467 0 0 0 7.179 4H8V3H5.519l.128-.129L4.59 1.813l-.707.707.48.48H2v1h.768a6.176 6.176 0 0 0 1.418 2.414 5.84 5.84 0 0 1-1.79.768l.242.97A6.723 6.723 0 0 0 4.97 7.086c.011.008.025.014.036.022a2.167 2.167 0 0 1 1.727-2.064zM3.83 4h2.284a5.056 5.056 0 0 1-1.148 1.777A4.957 4.957 0 0 1 3.83 4zm10.362 12H7.808A1.81 1.81 0 0 1 6 14.192V7.808A1.81 1.81 0 0 1 7.808 6h6.384A1.81 1.81 0 0 1 16 7.808v6.384A1.81 1.81 0 0 1 14.192 16zM7.808 7A.809.809 0 0 0 7 7.808v6.384a.809.809 0 0 0 .808.808h6.384a.809.809 0 0 0 .808-.808V7.808A.809.809 0 0 0 14.192 7zm5.342 6.94l.899-.439L11 7.261l-3.049 6.24.899.44.46-.941h3.38zM9.798 12L11 9.54 12.202 12z"},430745:(e,t,s)=>{s.d(t,{G0:()=>r,Gp:()=>l,Q$:()=>h,RO:()=>o,ak:()=>g,d1:()=>m,eh:()=>p,fo:()=>y,p4:()=>u,pV:()=>d,t0:()=>n,tu:()=>i,uL:()=>a,wo:()=>c});let i="item-end-reached",o="stop-scrolling-item",a="autoplay-next-item",r="toggle-item-autoplay",n="toggle-item-speed",l="reset-item",p="iframe-ready-for-communication",c="enable-item-autoplay",d="disable-item-autoplay",h="update-parent-pause",m="active-item-iframe",y=1500,g=1e3,u={slow:{displaySpeed:"1/2x",pageScrollDelay:40,collectionAutoplayDuration:12e4,briefingAutoplayDuration:6e4},medium:{displaySpeed:"1x",pageScrollDelay:20,collectionAutoplayDuration:6e4,briefingAutoplayDuration:3e4},fast:{displaySpeed:"2x",pageScrollDelay:10,collectionAutoplayDuration:3e4,briefingAutoplayDuration:15e3}}},447201:(e,t,s)=>{s.d(t,{O8:()=>_,V:()=>L});var i=s(385526),o=s(213218),a=s(331366),r=s(564872),n=s(885760),l=s(101570),p=s(918300),c=s(151130),d=s(269116),h=s(874717),m=s(20421),y=s(724490),g=s(647345),u=s(230658),x=s(777011),f=s(325247),A=s(674772);let w=async(e,t,s)=>{let i,o=e=>{},a=await (0,A.O$)(e,{maxRetries:1,promiseArguments:e=>t(o(e)),onError:e=>{console.error({err:e,debugInfo:s});let t=[f.ZJ.APP_BLOCKED_FOR_ORG,f.ZJ.ITEM_ACCESS_UNAUTHORIZED,f.ZJ.ITEM_NONEXISTENT_OR_INACCESSIBLE,f.ZJ.SUBSCRIPTION_DISABLED,f.ZJ.OWNER_SUBSCRIPTION_DISABLED,f.ZJ.SUBSCRIPTION_CANCELED,f.ZJ.INVALID_TOKEN,"HTTP 403"];return!(e instanceof Error&&(e instanceof x.Lf&&t.includes(e.code)||"string"==typeof e.message&&/items\/[a-zA-Z0-9]{32}\/data/.test(e.message)&&"invalid-json"===e.type))}});return clearTimeout(i),a};var b=s(159004),v=s(387189),I=s(602422),S=s(54302),T=s(971552),k=s(419403),D=s(668061),j=s(285161);let C=e=>{if(void 0!==e){if(e.req?.url)return e.req.url;if("pathname"in e)return e.asPath??`${e.pathname}${(0,y.X2)(e.query)}`}},$=e=>{let{itemDetails:t,expectedItemType:s,url:a}=e,r=(0,g.WE)(t),n=a&&a.includes("/templates")&&a.includes(t.id);if(!(0,i.Z3)(t,s)||r&&!n||!r&&n){let e=(0,g.EN)(t);throw new o.D({type:"item-not-supported-on-route",itemType:e})}},L=async e=>{let{id:t,authManager:s,config:i,ctx:o,itemType:p,translationOptions:c,shouldRedirect:d}=e;if(p===u.z.Frame){if(!i.ENABLE_FRAMES)return{redirect:{asPath:`${i.BASE_URL}/error`},success:!1};if(o?.req?.url?.includes("test"))return E(i,t)}if(!t)throw Error(`no ${p} id`);if(void 0!==o){let{res:e}=o;e?.setHeader?.("Vary","Cookie")}let h={itemId:t,authManager:s,portalHost:i.PORTAL_HOST,timeStamp:"string"==typeof o?.query.ts?o.query.ts:void 0},m=!1,y={...h,type:p,config:i};try{let[u,x]=await Promise.all([w(a.A.fetchItemDetails,e=>[{...h,signal:e}],{function:"StoryItemViewer.fetchItemDetails",id:t,itemType:p}),w(a.A.fetchPublishedItemData,e=>[{...y,signal:e}],{function:"StoryItemViewer.fetchPublishedItemData",id:t,itemType:p})]);m=(0,g.WE)(u),$({itemDetails:u,expectedItemType:p,url:C(o)});let f=(0,r.$N)(x),A=c?.locale?(0,b.KN)(c.locale,c.supportedLanguages,c.fallbackLanguage):void 0;A&&(0,v.T)(u)?.translations?.[A]&&c?.autoTranslationTypeKeyword&&(0,I.Y)({typeKeywords:u.typeKeywords,typeKeywordId:c.autoTranslationTypeKeyword})?(f=f?c.locale:void 0,x=await w(a.A.fetchPublishedItemData,e=>[{...y,language:A,signal:e}],{function:"fetchPublishedItemData",id:t,itemType:p})):A&&c?.locale&&f?.startsWith(A)&&(f=c.locale);let T=await w(n.xT,e=>[{storyItemData:x,authManager:s,portalHost:i.PORTAL_HOST,signal:e}],{function:"fetchThemeItemInfo",id:t,itemType:p});if((0,S.m5)(u)||(0,g.tc)(u)&&("admin"===u.itemControl||"update"===u.itemControl)){let e=(0,l.i)(p,m),s=`/${e}/edit?id=${t}`,a=`${i.BASE_URL}/${e}/${t}/edit`;return d&&(0,k.w)({ctx:o,href:s,asPath:a}),{redirect:{asPath:a},success:!1}}if("public"!==u.access&&s)try{if(await w(j.r,e=>[{authManager:s,config:i,signal:e}],{function:"getUserAuthorization",id:t,itemType:p})==="user-unauthorized")throw Error("user-unauthorized")}catch(e){if(d)throw e;return{redirect:{asPath:`${i.BASE_URL}/error`},success:!1}}let D="";if(void 0!==o){let{req:t,res:s}=o;s&&"function"==typeof s.setHeader&&("public"===u.access?s.setHeader("Cache-Control",`public, max-age=${e.skipCache?0:i.CACHE_MAX_AGE}`):s.setHeader("Cache-Control",`private, max-age=${e.skipCache?0:i.NON_PUBLIC_CACHE_MAX_AGE}`)),D=t?.headers.host||""}return{id:t,itemDetails:(0,g.st)(u),publishedData:x,host:D,initialThemeItemInfo:T,...f?{pageLocale:f}:{},success:!0}}catch(t){return z(t,{...e,isTemplate:m})}},z=(e,t)=>{let{id:s,authManager:i,config:a,ctx:r,signInUrl:n,itemType:c,isTemplate:d,shouldRedirect:h}=t;if(e&&e.code)try{return(0,D.w)({ctx:r,authManager:i,signInUrl:n,error:e,config:a}),{redirect:{asPath:""},error:e,success:!1}}catch(e){throw new o.D(e)}if("string"==typeof e.message&&e.message.search(`items/${s}/data`)>=0&&"invalid-json"===e.type){let t=c===u.z.Collection?"edit":"preview",i=(0,l.i)(c,d);return h&&(0,k.w)({ctx:r,href:`/${i}/${t}?id=${s}`,asPath:`${a.BASE_URL}/${i}/${s}/${t}`}),{redirect:{asPath:`${a.BASE_URL}/${i}/${s}/${t}`},error:e,success:!1}}if("string"==typeof e.message&&"user-unauthorized"===e.message)return h&&(0,k.w)({ctx:r,href:`/error?errType=unsupported-account&itemType=${c}`,asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${c}`}),{redirect:{asPath:`${a.BASE_URL}/error?errType=unsupported-account&itemType=${c}`},error:e,success:!1};{if("string"!=typeof e.message||"item-not-supported-on-route"!==e.message||!s)return h&&(0,k.w)({ctx:r,href:`/error?itemType=${c}`,asPath:`${a.BASE_URL}/error?itemType=${c}`}),{redirect:{asPath:`${a.BASE_URL}/error?itemType=${c}`},error:e,success:!1};let o=t.convertRoute({routeDef:(0,p.WU)({route:"viewer",itemType:e.itemType,isTemplate:d,itemId:s}),featureDecisions:{canAccessExternalUrls:!1},config:a,authManager:i}),n="error?errType=item-not-supported-on-route`",l=`${a.BASE_URL}/${n}`;return h&&(0,k.w)({ctx:r,href:R(o.href,n),asPath:o.as||l}),{redirect:{asPath:o.as||l},success:!1}}},_=async e=>{let{id:t,authManager:s,config:i,ctx:a,signInUrl:h,itemType:m,shouldRedirect:y}=e;if(!t)throw Error(`no ${m} id`);if(t===c.p8)return M(e);let u={itemId:t,authManager:s,portalHost:i.PORTAL_HOST},x=!1;try{let e=await d.Ay.fetchItemDetails(u);x=(0,g.WE)(e);let p=(0,l.i)(m,x);if($({itemDetails:e,expectedItemType:m,url:C(a)}),e.origin)return y&&(0,k.w)({ctx:a,href:`/${p}/${t}`,asPath:`${i.BASE_URL}/${p}/${t}`}),{success:!1,redirect:{asPath:`${i.BASE_URL}/${p}/${t}`}};if("update"===e.itemControl||"admin"===e.itemControl){if((0,S.m5)(e)||(0,g.tc)(e))return y&&(0,k.w)({ctx:a,href:`/${p}/edit?id=${t}`,asPath:`${i.BASE_URL}/${p}/${t}/edit`}),{success:!1,redirect:{asPath:`${i.BASE_URL}/${p}/${t}/edit`}};if(void 0!==a){let{res:e}=a;e&&"function"==typeof e.setHeader&&e.setHeader("Cache-Control","max-age=0, private, must-revalidate")}let{itemData:o}=await d.Ay.fetchItemDraftData({itemDetails:e,type:m,authManager:s,portalHost:i.PORTAL_HOST,config:i}),l=await (0,n.xT)({storyItemData:o,authManager:s,portalHost:i.PORTAL_HOST}),c=(0,r.$N)(o);return{success:!0,id:t,itemDetails:e,draftData:o,initialThemeItemInfo:l,pageLocale:c}}throw new o.D({type:"story-privileges-preview",itemType:m})}catch(r){if("string"==typeof r.message&&"item-not-supported-on-route"===r.message&&t){let o=e.convertRoute({routeDef:(0,p.WU)({route:"preview",itemType:r.itemType,itemId:t,isTemplate:x}),featureDecisions:{canAccessExternalUrls:!1},config:i,authManager:s}),n="error?errType=item-not-supported-on-route`",l=`${i.BASE_URL}/${n}`;return y&&(0,k.w)({ctx:a,href:R(o.href,n),asPath:o.as||l}),{redirect:{asPath:o.as||l},success:!1}}if(r instanceof o.D)throw new o.D(r);return(0,D.w)({ctx:a,authManager:s,signInUrl:h,error:r,config:i}),{redirect:{asPath:""},error:r,success:!1}}},M=e=>{let{config:t,formatMessage:s}=e;return{success:!0,...(0,c.bS)({formatMessage:s,baseUrl:t.BASE_URL,siteUrl:(0,T.I)({siteUrl:t.SITE_URL,isComponentMounted:!0,isScriptEmbedded:t.IS_SCRIPT_EMBEDDED}),productName:t.PRODUCT_NAME,baseThemeId:(0,h.Le)(t.INCLUDED_STORY_THEMES)}),initialThemeItemInfo:{}}},E=(e,t)=>{let s={...(0,m.Qe)({itemType:u.z.Frame,config:e,isTemplate:!1}),created:0x3226cbbfd,modified:0x3226cbbfd,owner:"ton12618@esri.com",numViews:1e4,id:t||"",size:2},i=(0,m.k4)(e.BASE_URL);return{id:t||"",itemDetails:(0,g.st)(s),publishedData:i,host:"",initialThemeItemInfo:{},success:!0}},R=(e,t)=>"object"==typeof e&&e.pathname?e.pathname:"string"==typeof e?e:t},470660:(e,t,s)=>{s.d(t,{G:()=>i});let i="M15.167 13a.834.834 0 0 0 .833-.834V1.834A.834.834 0 0 0 15.167 1H.833A.834.834 0 0 0 0 1.833v10.334A.834.834 0 0 0 .833 13H6v1H5v1h6v-1h-1v-1zM1 2h14v10H1zm8 12H7v-1h2z"},583886:(e,t,s)=>{s.d(t,{a:()=>i});let i="M22.766 13.875c.063.058.128.11.189.17l5 5a6.3 6.3 0 0 1-8.91 8.91l-5-5a6.286 6.286 0 0 1 2.969-10.568 3.279 3.279 0 0 1 .553.905 5.288 5.288 0 0 0-2.815 8.956l5 5a5.3 5.3 0 0 0 7.496-7.496l-4.488-4.488a8.366 8.366 0 0 0 .006-1.389zm-12.526 3.86l-4.488-4.487a5.3 5.3 0 0 1 7.496-7.496l5 5a5.288 5.288 0 0 1-2.815 8.956 3.278 3.278 0 0 0 .553.905 6.287 6.287 0 0 0 2.969-10.568l-5-5a6.3 6.3 0 0 0-8.91 8.91l5 5c.061.06.126.112.189.17a8.367 8.367 0 0 1 .006-1.39z"},592578:(e,t,s)=>{s.d(t,{k:()=>i});let i="M8 14h3v1H4v-1h3v-4H1V2H0V1h15v1h-1v3h-1V2H2v7h7v1H8v4zm7.928-8.121l-.707-.707L13 7.292l-2.221-2.22-.707.707L12.292 8l-2.22 2.221.707.707L13 8.708l2.221 2.22.707-.707L13.708 8l2.22-2.121z"},617709:(e,t,s)=>{s.d(t,{$:()=>a,C:()=>o});var i=s(455729);let o=(0,i.createContext)({collectionData:{titlesArray:[],updateCollectionData:()=>{}},collectionDisplay:{currentIndex:-1,isCoverShowing:!0,isItemViewTransitionComplete:!1,updateCollectionDisplay:()=>{}}}),a=()=>(0,i.useContext)(o)},656228:(e,t,s)=>{s.d(t,{A:()=>m,g:()=>h});var i=s(406029),o=s(94588),a=s.n(o);s(455729);var r=s(332988),n=s.n(r),l=s(167791),p=s(894368),c=s(874400),d=s(917318);let h=e=>{let t=(0,l.st)(),s=e.trackingEventData?t.getDataAttributes(e.trackingEventData):{},o={styles:(0,i.jsx)(a(),{id:"fdb33912e95ade24",children:".media-toolbar-button.flipped.jsx-fdb33912e95ade24{-webkit-transform:scale(-1,1);-moz-transform:scale(-1,1);-ms-transform:scale(-1,1);-o-transform:scale(-1,1);transform:scale(-1,1)}"}),className:"jsx-fdb33912e95ade24"},r=(0,i.jsxs)(p.Ay,{type:e.type??"single-icon",id:e.buttonId,onClick:e.onClick,className:n()("media-toolbar-button",o.className,{flipped:e.shouldFlip}),disabled:e.disabled,visuallyHiddenLabel:e.tooltipContent,...s,"aria-pressed":e["aria-pressed"]&&!e.disabled,"aria-expanded":e["aria-expanded"],"aria-haspopup":e["aria-haspopup"],onMouseLeave:e.onMouseLeave,testId:e.buttonId,children:[(0,i.jsx)(c.A,{...e.iconProps,size:16}),e.buttonTextContent,o.styles]});return(0,i.jsxs)(d.m_,{children:[(0,i.jsx)(d.k$,{autoARIADescribedByEnabled:!1,children:e.renderButton?.(r)??r}),(0,i.jsx)(d.ZI,{children:e.tooltipContent})]},e.buttonId)},m=h},668718:(e,t,s)=>{s.d(t,{BN:()=>n,Rq:()=>r,iO:()=>l});var i=s(406029),o=s(455729);let a=(0,o.createContext)({isExpanded:!1,updateIsExpanded:()=>void 0}),r=()=>(0,o.useContext)(a),n=e=>{let{children:t}=e,[s,r]=(0,o.useState)({}),n=(0,o.useCallback)((e,t)=>{if(e&&!s[t])r({...s,[t]:!0});else if(!e&&s[t]){let e={...s};delete e[t],r(e)}},[s]),l=(0,o.useMemo)(()=>({isExpanded:!!Object.values(s).length,updateIsExpanded:n}),[s,n]);return(0,i.jsx)(a.Provider,{value:l,children:t})},l=e=>class extends o.PureComponent{render(){return(0,i.jsx)(a.Consumer,{children:t=>(0,i.jsx)(e,{...this.props,mediaExpandedContext:t})})}}},690314:(e,t,s)=>{s.d(t,{e:()=>i});let i="M4 1.571V14.43L14 8zm1 1.832l7.15 4.598L5 12.597z"},698654:(e,t,s)=>{s.d(t,{o:()=>i});let i="M12 16a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1zM5 1h7v1H5zm0 2h7v9H5zm0 10h7v2H9v-1H8v1H5z"},725504:(e,t,s)=>{s.d(t,{j:()=>r});var i=s(213218),o=s(874867),a=s(717483);let r=e=>{let{itemType:t,dataPreparer:s,privilegesChecker:r}=e;return async(e,n)=>{let{id:l}=e.query,{authManager:p,config:c,signInUrl:d,storyMapUserPrivileges:h}=n,m=r?.(h);if(m)throw m;if("string"!=typeof l||!(0,o.D)(l))throw new i.D({type:"story-inaccessible",itemType:t});return await s({ctx:e,id:l,config:c,authManager:p,signInUrl:d,itemType:t,shouldRedirect:!0,convertRoute:a.N})}}},766216:(e,t,s)=>{s.d(t,{c:()=>i});let i="M11 7V6h3v9H3V6h3v1H4v7h9V7zM6.74 4L8 2.739V11h1V2.705L10.295 4l.324.324.707-.707L8.517.807l-2.809 2.81.707.707z"},934829:(e,t,s)=>{s.d(t,{e:()=>o,r:()=>a});var i=s(455729);let o=(0,i.createContext)({briefingDisplay:{currentIndex:0,totalNumberOfSlides:0,isStoryItemOutlineShowing:!1},updateBriefingDisplay:()=>{},setOnUpdateCurrentlyIndex:()=>null}),a=()=>(0,i.useContext)(o)}}]);