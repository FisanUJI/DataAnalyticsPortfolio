"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[39663],{239663:(e,t,a)=>{a.d(t,{NV:()=>N,LD:()=>E,eb:()=>C,bO:()=>P,hk:()=>j,Ni:()=>x,k9:()=>F,eD:()=>_,V4:()=>k});var r=a(406029);a(455729);var i=a(390248),s=a(647682),o=a(54302),n=a(230658),m=a(254033),l=a(802515),c=a(142529),d=a(462829),h=a(724490);let p=e=>window.performance.getEntriesByType("resource").filter(t=>"string"==typeof e?t.name===e:e.test(t.name));var u=a(960642),y=a(674772),g=a(647345),w=a(602422),f=a(34863),T=a(531024),A=a(101570),b=a(20421),v=a(874717);let $=e=>{let{baseThemeId:t}=e,{defaultBaseVariables:a}=(0,v.ao)(t),r={...a};return delete r.colorRamps,{baseThemeId:t,variables:r}};var S=a(385526);let C=async e=>{try{await (0,o.wS)({isFavorite:!0,itemId:e.id,authManager:e.authManager,owner:e.owner}),e.toast.add({type:"success",title:(0,r.jsx)(i.A,{id:"itemUtils.addFavorite.success"})})}catch(t){throw e.toast.add({type:"error",title:(0,r.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,r.jsx)(i.A,{id:"itemUtils.addFavorite.error"})}),Error(t)}},k=async e=>{try{await (0,o.wS)({isFavorite:!1,itemId:e.id,authManager:e.authManager,owner:e.owner}),e.toast.add({type:"success",title:(0,r.jsx)(i.A,{id:"itemUtils.removeFavorite.success"})})}catch(t){throw e.toast.add({type:"error",title:(0,r.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,r.jsx)(i.A,{id:"itemUtils.removeFavorite.error"})}),Error(t)}},E=async e=>{let t,a=(0,r.jsx)(i.A,{id:"component.deleteItem.toast.title.permanent"});e.isRecycleBinEnabled&&!e.isPermanent&&(a=(0,r.jsx)(i.A,{id:"component.deleteItem.toast.title.recoverable"}),t=(0,r.jsx)(i.A,{id:"component.deleteItem.toast.description.recoverable"}));try{await (0,s.Ai)({authentication:e.authManager,id:e.id,...e.owner&&{owner:e.owner},params:e.isPermanent?{permanentDelete:!0}:{}}),e.toast.add({type:"success",title:a,details:t})}catch(t){throw e.toast.add({type:"error",title:(0,r.jsx)(i.A,{id:"builder.common.sorry"}),details:(0,r.jsx)(i.A,{id:"itemUtils.errorDeleting.item"})}),Error(t)}},I=e=>{switch(e.itemType){case n.z.Story:{if(e.isTemplate){m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStoryTemplate);break}let t={sidecar:m.A.Name.QuickStartTemplate_Sidecar,"guided-tour":m.A.Name.QuickStartTemplate_GuidedTour,explorer:m.A.Name.QuickStartTemplate_Explorer},a=(0,S.fO)(e.templateForStory)?t[e.templateForStory]:m.A.Name.QuickStartTemplate_Default;a&&m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStory,a),e.hasThemeForStory&&m.A.trackEvent(m.A.Category.Story,m.A.Action.Story_CreateNewStoryWithTheme);break}case n.z.Briefing:m.A.trackEvent(m.A.Category.Briefing,m.A.Action.Briefing_CreateBriefing);break;case n.z.Frame:m.A.trackEvent(m.A.Category.Frame,m.A.Action.Frame_CreateFrame);break;case n.z.Collection:m.A.trackEvent(m.A.Category.Collection,m.A.Action.Collection_CreateCollection);break;case n.z.Theme:m.A.trackEvent(m.A.Category.Theme,m.A.Action.Theme_CreateNewTheme)}},N=async e=>{let t=await (0,l.HK)(e.authManager),a=await (0,b.q_)(e.config.BASE_URL),r=await e.authManager.getUser(),i=await (0,s.wE)({authentication:e.authManager,params:{thumbnail:a},item:(0,b.Qe)({itemType:e.itemType,config:e.config,isPublicUser:t,orgId:r.orgId,isTemplate:e.isTemplate})}),o=(()=>{switch(e.itemType){case n.z.Story:return(0,b.ou)({firstName:r.firstName,lastName:r.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId,webmap:e.webmap,webscene:e.webscene,template:e.template,shouldIncludeAuthorCard:e.featureDecisions.canUseAuthorCard,coverType:e.config.INCLUDED_STORY_COVERS[0],isTemplate:e.isTemplate});case n.z.Briefing:return(0,b.Jk)({firstName:r.firstName,lastName:r.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId,coverType:e.config.INCLUDED_STORY_COVERS[0]});case n.z.Frame:return(0,b.k4)(e.config.BASE_URL);case n.z.Collection:return(0,b.Dr)({firstName:r.firstName,lastName:r.lastName,title:e.title,theme:e.theme,baseThemeId:e.baseThemeId});case n.z.Theme:return $({baseThemeId:e.baseThemeId});default:return{}}})();return e.itemType===n.z.Story&&e.theme&&(await (0,s.xg)({originItemId:e.theme,destinationItemId:i.id,relationshipType:c.wx,authentication:e.authManager}),m.A.trackEvent(m.A.Category.Theme,m.A.Action.Theme_AddRelationshipTheme2Story)),await (0,s.zk)({authentication:e.authManager,id:i.id,name:"draft.json",resource:(0,d.YX)(o),owner:e.authManager.username,private:!0}),e.itemType===n.z.Story?I({itemType:e.itemType,templateForStory:e.template,hasThemeForStory:!!e.theme,isTemplate:e.isTemplate}):I({itemType:e.itemType,isTemplate:e.isTemplate}),i},x=e=>{let{storyUrl:t,getUrlFromRouteDef:a}=e;return a({route:"report-abuse",storyUrl:(0,h.wz)(t||window.location.href,["play","speed","cover","header"])})},_=e=>{let{itemId:t,portalHost:a,authManager:r,customTracker:i}=e;try{let e=p(RegExp(`sharing/rest/content/items/${t}/data`)),o=window.performance.now(),n=e.reduce((e,t)=>{let a=o-t.startTime;return Math.min(a,e)},1/0);(0===e.length||isFinite(n)&&n>9999)&&(0,y.E4)(()=>{(0,s.MB)(t,{authentication:r,portal:(0,u.mZ)(a,r)}),i?.()},void 0,3e3)}catch{}},z=e=>{let{isMobile:t,isDraft:a,isOwner:r,isCollection:i,isTheme:s}=e;return s?r?"edit":"new?theme=":t?a&&!i?"preview":"view":a&&r?"edit":"view"},F=(e,t,a)=>{let{typeKeywords:r}=e,i=(0,g.EN)(e),s=i===n.z.Collection,o=(0,g.WE)(e),m=(0,w.Y)({typeKeywords:r,typeKeywordId:f.hX.draft});return(s&&!m&&(r&&r.length&&(r.indexOf(f.hX.published)>=0||r.indexOf(f.hX.unpublishedChanges)>=0)?m=!1:"private"===e.access&&(m=!0)),i===n.z.Theme)?a?"builder":"create":"small"===t||"medium"===t?m&&!s?o?"preview-template":"preview":o?"viewer-template":"viewer":m&&a?o?"builder-template":"builder":o?"viewer-template":"viewer"},P=e=>{let{routeModifier:t,actionType:a,itemId:r,basePath:i}=e,s="view"===a?"":`/${a}`;return a.includes("new")?{href:`/${t}/${a}${r}`,asPath:`${i}/${t}${s}${r}`}:a.includes("check-issues")?{href:`/${t}/edit?id=${r}&checkIssues=true`,asPath:`${i}/${t}/${r}/edit?checkIssues=true`}:{href:`/${t}/${a}?id=${r}`,asPath:`${i}/${t}/${r}${s}`}},M=(e,t,a,r)=>{let{typeKeywords:i}=e,s=(0,g.EN)(e),o=s===n.z.Collection,m=(0,g.WE)(e),l=!!(i&&i.length&&i.indexOf(f.hX.draft)>=0);o&&!l&&(i&&i.length&&(i.indexOf(f.hX.published)>=0||i.indexOf(f.hX.unpublishedChanges)>=0)?l=!1:"private"===e.access&&(l=!0));let c=z({isDraft:l,isMobile:"small"===t||"medium"===t,isOwner:a,isCollection:o,isTheme:s===n.z.Theme}),d=(0,A.i)(s,m);return s!==n.z.Theme||a||(d="stories"),P({routeModifier:d,itemId:e.id,actionType:c,basePath:r})},j=e=>{let t=!!e.authManager&&e.authManager.username===e.item.owner,a=(0,u.yu)(e.portalHost,e.authManager);if(e.item.type===f.J6.Dashboard)return{href:`${a}/apps/dashboards/${e.item.id}`,asPath:""};if(e.item.type===f.J6.WebExperience)return e.isPortal?{href:`${a}/apps/experiencebuilder/experience/?id=${e.item.id}`,asPath:""}:{href:`https://experience${(0,T.oj)(e.portalHost)}.arcgis.com/experience/${e.item.id}`,asPath:""};if(e.item.type===f.J6.InsightsPage)return e.isPortal?{href:`${a}/apps/insights/#/embed/${e.item.id}`,asPath:""}:{href:`https://insights${(0,T.oj)(e.portalHost)}.arcgis.com/#/embed/${e.item.id}`,asPath:""};if(e.item.type!==c.tm&&e.item.type!==c.Jk&&e.item.url)return{href:(0,h.FB)(e.item.url),asPath:""};if(e.item.type===f.J6.Image||e.item.type===f.J6.PDF)return{href:`${a}/sharing/rest/content/items/${e.item.id}/data`,asPath:""};else if(e.item.type===f.J6.Survey123)return{href:`https://survey123${(0,T.oj)(e.portalHost)}.arcgis.com/share/${e.item.id}?portalUrl=${a}&hide=navbar,footer`,asPath:""};return M(e.item,e.screenWidth,t,e.baseUrl)}}}]);